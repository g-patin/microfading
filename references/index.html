
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../explanation/">
      
      
        <link rel="next" href="../installation/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>References - microfading</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#microfading.microfading" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="microfading" class="md-header__button md-logo" aria-label="microfading" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            microfading
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              References
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="microfading" class="md-nav__button md-logo" aria-label="microfading" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    microfading
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome !
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../first-steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    First steps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assess-light-sensitivity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assess light sensitivity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generate-report/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate report
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    How-to-guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            How-to-guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../manage-databases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../retrieve-test-datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Retrieve test datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create-MFT-class-instance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    create MFT class instance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualize-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualize data
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../explanation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Explanation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    References
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    References
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading" class="md-nav__link">
    <span class="md-ellipsis">
      microfading
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.MFT" class="md-nav__link">
    <span class="md-ellipsis">
      MFT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MFT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.meas_ids" class="md-nav__link">
    <span class="md-ellipsis">
      meas_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.wavelength" class="md-nav__link">
    <span class="md-ellipsis">
      wavelength
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.Lab" class="md-nav__link">
    <span class="md-ellipsis">
      Lab
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.Lab--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.Lab--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.XYZ" class="md-nav__link">
    <span class="md-ellipsis">
      XYZ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XYZ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.XYZ--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.XYZ--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.data_points" class="md-nav__link">
    <span class="md-ellipsis">
      data_points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="data_points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.data_points--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.data_points--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.delta" class="md-nav__link">
    <span class="md-ellipsis">
      delta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="delta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.delta--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.delta--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.fit_data" class="md-nav__link">
    <span class="md-ellipsis">
      fit_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fit_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.fit_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.fit_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_metadata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.mean" class="md-nav__link">
    <span class="md-ellipsis">
      mean
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mean">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.mean--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.mean--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.mean--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp" class="md-nav__link">
    <span class="md-ellipsis">
      plot_sp
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_sp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files" class="md-nav__link">
    <span class="md-ellipsis">
      read_files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="read_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.sRGB" class="md-nav__link">
    <span class="md-ellipsis">
      sRGB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sRGB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.sRGB--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.sRGB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_illuminant" class="md-nav__link">
    <span class="md-ellipsis">
      set_illuminant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="set_illuminant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_illuminant--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_illuminant--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_observer" class="md-nav__link">
    <span class="md-ellipsis">
      set_observer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="set_observer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_observer--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_observer--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.sp_derivation" class="md-nav__link">
    <span class="md-ellipsis">
      sp_derivation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sp_derivation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.sp_derivation--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.xy" class="md-nav__link">
    <span class="md-ellipsis">
      xy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="xy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.xy--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.xy--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.create_DB" class="md-nav__link">
    <span class="md-ellipsis">
      create_DB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create_DB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.create_DB--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.create_DB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.folder_DB" class="md-nav__link">
    <span class="md-ellipsis">
      folder_DB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="folder_DB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.folder_DB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      get_datasets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading" class="md-nav__link">
    <span class="md-ellipsis">
      microfading
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.MFT" class="md-nav__link">
    <span class="md-ellipsis">
      MFT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MFT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.meas_ids" class="md-nav__link">
    <span class="md-ellipsis">
      meas_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.wavelength" class="md-nav__link">
    <span class="md-ellipsis">
      wavelength
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.Lab" class="md-nav__link">
    <span class="md-ellipsis">
      Lab
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.Lab--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.Lab--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.XYZ" class="md-nav__link">
    <span class="md-ellipsis">
      XYZ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XYZ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.XYZ--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.XYZ--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.data_points" class="md-nav__link">
    <span class="md-ellipsis">
      data_points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="data_points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.data_points--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.data_points--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.delta" class="md-nav__link">
    <span class="md-ellipsis">
      delta
    </span>
  </a>
  
    <nav class="md-nav" aria-label="delta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.delta--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.delta--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.fit_data" class="md-nav__link">
    <span class="md-ellipsis">
      fit_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fit_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.fit_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.fit_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_metadata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.get_metadata--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.mean" class="md-nav__link">
    <span class="md-ellipsis">
      mean
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mean">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.mean--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.mean--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.mean--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp" class="md-nav__link">
    <span class="md-ellipsis">
      plot_sp
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_sp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.plot_sp--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files" class="md-nav__link">
    <span class="md-ellipsis">
      read_files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="read_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.read_files--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.sRGB" class="md-nav__link">
    <span class="md-ellipsis">
      sRGB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sRGB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.sRGB--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.sRGB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_illuminant" class="md-nav__link">
    <span class="md-ellipsis">
      set_illuminant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="set_illuminant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_illuminant--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_illuminant--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_observer" class="md-nav__link">
    <span class="md-ellipsis">
      set_observer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="set_observer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_observer--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.set_observer--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.sp_derivation" class="md-nav__link">
    <span class="md-ellipsis">
      sp_derivation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sp_derivation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.sp_derivation--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.xy" class="md-nav__link">
    <span class="md-ellipsis">
      xy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="xy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.xy--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.MFT.xy--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.create_DB" class="md-nav__link">
    <span class="md-ellipsis">
      create_DB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create_DB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.create_DB--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.create_DB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.folder_DB" class="md-nav__link">
    <span class="md-ellipsis">
      folder_DB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="folder_DB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.folder_DB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      get_datasets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microfading.microfading.get_datasets--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>References</h1>

<p>There is a new sentence !</p>


<div class="doc doc-object doc-module">



<a id="microfading.microfading"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="microfading.microfading.MFT" class="doc doc-heading">
            <code>MFT</code>


<a href="#microfading.microfading.MFT" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>object</code></p>


              <details class="quote">
                <summary>Source code in <code>src/microfading/microfading.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MFT</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">BWS</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">stdev</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate a Microfading (MFT) class object in order to manipulate and visualize microfading analysis data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        files : list</span>
<span class="sd">            A list of string, where each string corresponds to the absolute path of text or csv file that contains the data and metadata of a single microfading measurement. The content of the file requires a specific structure, for which an example can be found in &quot;datasets&quot; folder of the microfading package folder (Use the get_datasets function to retrieve the precise location of such example files). If the file structure is not respected, the script will not be able to properly read the file and access its content.</span>

<span class="sd">        BWS : bool, optional</span>
<span class="sd">            When False, it ignores the measurements performed on BWS samples if included. </span>

<span class="sd">        stdev: bool, optional</span>
<span class="sd">            Indicate whether the input files contains standard deviation values, by default False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="n">files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BWS</span> <span class="o">=</span> <span class="n">BWS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stdev</span> <span class="o">=</span> <span class="n">stdev</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BWS</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="k">if</span> <span class="s1">&#39;BW&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>





    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Microfading data class - Number of files = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>


    <span class="k">def</span> <span class="nf">data_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select colourimetric values for one or multiple light dose values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates : Optional[list], optional</span>
<span class="sd">            Select the desired colourimetric coordinates from the following list: [&#39;L*&#39;, &#39;a*&#39;,&#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;, &#39;dL*&#39;, &#39;da*&#39;,&#39;db*&#39;, &#39;dC*&#39;, &#39;dh&#39;, &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39;], by default [&#39;dE00&#39;]</span>

<span class="sd">        dose_unit : Optional[str], optional</span>
<span class="sd">            Select the unit of the light energy, by default [&#39;He&#39;]</span>
<span class="sd">            Any of the following units can be added to the list: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">            Select the values of the light energy, by default 1</span>
<span class="sd">            A single value, a list of multiple values, or range values with a tuple (start, end, step) can be entered.</span>

<span class="sd">        index : Optional[bool], optional</span>
<span class="sd">            Whether to set the index of the returned dataframes, by default False</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A list of pandas dataframes</span>
<span class="sd">            It returns the values of the wanted colour coordinates inside dataframes where each coordinate corresponds to a column.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Retrieve the range light dose values</span>
        <span class="n">doses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="n">dose_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">dose_values</span><span class="p">]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">dose_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dose_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">dose_values</span> <span class="o">=</span> <span class="n">dose_values</span>        

        <span class="c1"># Retrieve the data</span>
        <span class="n">original_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;cl&#39;</span><span class="p">)</span>

        <span class="c1"># Added the delta LabCh values to the data dataframes   </span>
        <span class="k">if</span> <span class="n">original_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

            <span class="n">delta_coord</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">unumpy</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">original_data</span><span class="p">]</span>

            <span class="n">delta_means</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">delta_coord</span><span class="p">]</span>
            <span class="n">delta_stds</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">std_devs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">delta_coord</span><span class="p">]</span>

            <span class="n">delta_coord_mean</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]]</span>
            <span class="n">delta_coord_std</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]]</span>

            <span class="c1"># Add the new columns to the dictionary</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">original_data</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">coord_mean</span><span class="p">,</span><span class="n">delta_mean</span><span class="p">,</span><span class="n">coord_std</span><span class="p">,</span><span class="n">delta_std</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">delta_coord_mean</span><span class="p">,</span><span class="n">delta_means</span><span class="p">,</span> <span class="n">delta_coord_std</span><span class="p">,</span><span class="n">delta_stds</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">coord_mean</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">delta_mean</span><span class="p">))</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">coord_mean</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_mean</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">coord_std</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_std</span>

                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>


            <span class="c1"># Select the wanted dose_unit and coordinate        </span>
            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="n">doses</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]]</span> <span class="o">+</span> <span class="n">coordinates</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>        
            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]})</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">original_data</span><span class="p">]</span>

            <span class="c1"># Select the wanted dose_unit and coordinate        </span>
            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="n">doses</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]]</span> <span class="o">+</span> <span class="n">coordinates</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>        
            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>

        <span class="c1"># Interpolation function, assuming linear interpolation</span>
        <span class="n">interp_functions</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Double comprehension list to interpolate each dataframe in wanted_data</span>
        <span class="n">interpolated_data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                <span class="n">col</span><span class="p">:</span> <span class="n">interp_functions</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])(</span><span class="n">dose_values</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
            <span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>
            <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">doses</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">])</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">wanted_data</span>
        <span class="p">]</span>

        <span class="c1"># Whether to set the index</span>
        <span class="k">if</span> <span class="n">index</span><span class="p">:</span>
            <span class="n">interpolated_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">interpolated_data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">interpolated_data</span>       


    <span class="k">def</span> <span class="nf">delta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;He&#39;</span><span class="p">],</span> <span class="n">rate</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the CIE delta values for a given set of colorimetric coordinates corresponding to the given microfading analyses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates : list, optional</span>
<span class="sd">            List of colorimetric coordinates, by default [&#39;dE00&#39;]</span>
<span class="sd">            Any of the following coordinates can be added to the list: &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39; , &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;.</span>

<span class="sd">        dose_unit : list, optional</span>
<span class="sd">            List of light energy doses, by default [&#39;He&#39;]</span>
<span class="sd">            Any of the following units can be added to the list: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        rate : bool, optional</span>
<span class="sd">            Whether to return the first derivative values of the desired coordinates, by default False</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _type_</span>
<span class="sd">            Returns a Pandas dataframe where each column corresponds to a desired coordinate or light energy dose.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">doses_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span> 
        <span class="n">doses_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dose_unit</span><span class="p">]</span>

        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdev</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span> 

            <span class="n">doses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">doses_labels</span><span class="p">)</span> 
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">coordinates</span><span class="p">)</span>        


            <span class="k">for</span> <span class="n">el_data</span><span class="p">,</span><span class="n">el_dose</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">doses</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">el_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">]:</span>
                        <span class="n">values</span> <span class="o">=</span> <span class="n">el_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                        <span class="n">values_delta</span> <span class="o">=</span> <span class="n">values</span> <span class="o">-</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   

                        <span class="n">el_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_delta</span>
                        <span class="n">el_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">col</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">rate</span><span class="p">:</span>   

                    <span class="n">step_dose</span> <span class="o">=</span> <span class="n">el_dose</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">el_dose</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                    <span class="n">el_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">el_data</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">step_dose</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">el_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

                <span class="n">wanted_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">el_dose</span><span class="p">,</span> <span class="n">el_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>


        <span class="k">else</span><span class="p">:</span>

            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">coordinates</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">coordinates</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
            <span class="n">doses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">doses_labels</span><span class="p">)</span>
            <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">doses</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>

            <span class="n">new_columns</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">]:</span>
                        <span class="n">new_columns</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">new_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

                <span class="n">i</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">new_columns</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">i</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>          


        <span class="k">return</span> <span class="n">wanted_data</span>


    <span class="k">def</span> <span class="nf">fit_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_data</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;dE00&#39;</span><span class="p">,</span> <span class="n">equation</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;c0*(x**c1)&#39;</span><span class="p">,</span> <span class="n">initial_params</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">x_range</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1001</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">save</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit the values of a given colourimetric coordinates. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plot : bool, optional</span>
<span class="sd">            Whether to show the fitted data, by default False</span>

<span class="sd">        return_data : bool, optional</span>
<span class="sd">            Whether to return the fitted data, by default False</span>

<span class="sd">        dose_unit : string, optional</span>
<span class="sd">            Select the light energy dose, by default &#39;He&#39;</span>
<span class="sd">            Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">        coordinates : string, optional</span>
<span class="sd">            Select the desired colourimetric coordinates from the following list: [&#39;L*&#39;, &#39;a*&#39;,&#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;, &#39;dL*&#39;, &#39;da*&#39;,&#39;db*&#39;, &#39;dC*&#39;, &#39;dh&#39;, &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39;], by default &#39;dE00&#39;</span>

<span class="sd">        equation : str, optional</span>
<span class="sd">            Mathematical equation used to fit the coordinate values, by default &#39;c0*(x**c1)&#39;</span>

<span class="sd">        initial_params : Optional[List[float]], optional</span>
<span class="sd">            Initial guesses of the &#39;c&#39; parameters given in the equation (c0, c1, c2, etc.), by default [0.1, 0.0]</span>

<span class="sd">        x_range : Optional[Tuple[int]], optional</span>
<span class="sd">            Values along which the fitted values should be computed (start, end, step), by default (0, 1001, 1)</span>

<span class="sd">        save : Optional[bool], optional</span>
<span class="sd">            Whether to save the plot, by default False</span>

<span class="sd">        path_fig : Optional[str], optional</span>
<span class="sd">            Absolute path of the figure to be saved, by default &#39;default&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Union[None, Tuple[np.ndarray, np.ndarray]]</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Retrieve the range light dose values</span>
        <span class="n">doses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>  
        <span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">*</span><span class="n">x_range</span><span class="p">)</span>

        <span class="c1"># Retrieve the data</span>
        <span class="n">original_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;cl&#39;</span><span class="p">)</span>

        <span class="c1">#original_data = self.get_data(data=&#39;dE&#39;) if self.data_category == &#39;interim&#39; else self.get_data(data=&#39;dE&#39;)[0].astype(float)</span>

        <span class="c1"># Added the delta LabCh values to the data dataframes</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">})</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">original_data</span><span class="p">]</span>

        <span class="c1"># Select the wanted dose_unit and coordinate</span>
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="n">doses</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="n">coordinate</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>

        <span class="c1"># Define the function to fit</span>
        <span class="k">def</span> <span class="nf">fit_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
            <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;c</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">param</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">params</span><span class="p">)}</span>
            <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">equation</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="n">param_dict</span><span class="p">)</span>

        <span class="c1"># Define boundaries for the parameters</span>
        <span class="c1">#bounds = ([-np.inf] * len(initial_params), [np.inf, 1]) if len(initial_params) == 2 else ([-np.inf] * len(initial_params), [np.inf, 1, np.inf])</span>

        <span class="c1"># Create an empty dataframe for the fitted data</span>
        <span class="n">fitted_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x_values</span><span class="p">))</span>

        <span class="c1"># Empty list to store the labels</span>
        <span class="n">fitted_labels</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Emtpy list to store the optimized parameters</span>
        <span class="n">fitted_parameters</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">:</span>
            <span class="c1"># retrieve the x(light dose) and y(coordinate) values</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># perform the curve fitting</span>
            <span class="n">optimized_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">fit_function</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">initial_params</span><span class="p">,</span> <span class="p">)</span> <span class="c1"># bounds=bounds</span>

            <span class="c1"># generate fitted y data</span>
            <span class="n">fitted_y</span> <span class="o">=</span> <span class="n">fit_function</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="o">*</span><span class="n">optimized_params</span><span class="p">)</span>

            <span class="c1"># append it to the fitted_data dataframe</span>
            <span class="n">fitted_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">fitted_data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fitted_y</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x_values</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="c1"># Calculate R-squared value</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">fit_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">optimized_params</span><span class="p">)</span>
            <span class="n">ss_res</span><span class="p">,</span> <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>        
            <span class="n">r_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">ss_res</span> <span class="o">/</span> <span class="n">ss_tot</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>

            <span class="c1"># Create a string representation of the equation with optimized parameters</span>
            <span class="n">optimized_equation</span> <span class="o">=</span> <span class="n">equation</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">optimized_params</span><span class="p">):</span>
                <span class="n">optimized_equation</span> <span class="o">=</span> <span class="n">optimized_equation</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;c</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>

            <span class="n">fitted_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">optimized_equation</span><span class="si">}</span><span class="s1">, $R^2$ = </span><span class="si">{</span><span class="n">r_squared</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fitted_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optimized_params</span><span class="p">)</span>

        <span class="n">fitted_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, $y$ = </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span><span class="p">,</span> <span class="n">fitted_labels</span><span class="p">)]</span>         

        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
            <span class="n">labels_eq</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;L*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $L^*$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;a*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $a^*$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;b*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $b^*$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;C*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $C^*$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $h$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;dE76&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\Delta E^*_</span><span class="si">{ab}</span><span class="s1">$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;dE00&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\Delta E^*_</span><span class="si">{00}</span><span class="s1">$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;dR_VIS&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\Delta R_{\rm vis}$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;dL*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $\Delta L^*$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;da*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $\Delta a^*$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;db*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $\Delta b^*$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;dC*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $\Delta C^*$&#39;</span><span class="p">,</span>
                <span class="s1">&#39;dh&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $\Delta h$&#39;</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="n">labels_H</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="s1">&#39;Exposure dose $H_v$ (Mlxh)&#39;</span><span class="p">,</span>
                <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;Radiant Exposure $H_e$ (MJ/m²)&#39;</span><span class="p">,</span>
                <span class="s1">&#39;t&#39;</span> <span class="p">:</span> <span class="s1">&#39;Exposure duration (seconds)&#39;</span>
            <span class="p">}</span>

            <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
            <span class="n">fs</span> <span class="o">=</span> <span class="mi">24</span>


            <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">wanted_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">fitted_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

            <span class="c1">#meas_line, = ax.plot(x,y, ls=&#39;-&#39;, lw=3)            </span>
            <span class="c1">#fitted_line, = ax.plot(x_values,fitted_y, ls=&#39;--&#39;, lw=2)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">labels_H</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels_eq</span><span class="p">[</span><span class="n">coordinate</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

            <span class="c1">#title = f&#39;Microfading, {self.Id}, data fitting&#39;</span>
            <span class="c1">#ax.set_title(title, fontsize = fs-4)   </span>

<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            if coordinate.startswith(&#39;d&#39;):                </span>
<span class="sd">                ax.set_ylim(0) </span>
<span class="sd">            &#39;&#39;&#39;</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    

            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

            <span class="c1">#plt.legend([meas_line,fitted_line], [&quot;original data&quot;,f&quot;$f(x) = {optimized_equation}$\n$R^2 = {r_squared:.3f}$&quot;],fontsize=fs-6)</span>
            <span class="c1">#plt.tight_layout()</span>


            <span class="k">if</span> <span class="n">save</span><span class="p">:</span>

                <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_filename</span><span class="p">(</span><span class="s1">&#39;dEfit&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">save</span><span class="p">:</span>            
                    <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                        <span class="n">path_fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_folder_figures</span><span class="p">()</span> <span class="o">/</span> <span class="n">filename</span>

                    <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;cwd&#39;</span><span class="p">:</span>
                        <span class="n">path_fig</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span> 

                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_fig</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fitted_parameters</span><span class="p">,</span> <span class="n">fitted_data</span>


    <span class="k">def</span> <span class="nf">read_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;spectra&#39;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read the data files given as argument when defining the instance of the MFT class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sheets : Optional[list], optional</span>
<span class="sd">            Name of the excel sheets to be selected, by default [&#39;info&#39;, &#39;CIELAB&#39;, &#39;spectra&#39;]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas dataframe</span>
<span class="sd">            It returns of the content of the files where the each column relates to a file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>        

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>

            <span class="n">df_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
            <span class="n">df_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;spectra&#39;</span><span class="p">)</span>
            <span class="n">df_cl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;std&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_sp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                <span class="n">df_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">df_cl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>


            <span class="k">if</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_cl</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_sp</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_cl</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">files</span>


    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">xarray</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the microfading data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : str|list, optional</span>
<span class="sd">            Possibility to select the type of data, by default &#39;all&#39;.</span>
<span class="sd">            When &#39;all&#39;, it returns all the data (spectral and colorimetric).</span>
<span class="sd">            When &#39;sp&#39;, it only returns the spectral data.</span>
<span class="sd">            When &#39;cl&#39;, it only returns the colorimetric data.  </span>
<span class="sd">            When &#39;Lab&#39;, it returns the CIE L*a*b* values.</span>
<span class="sd">            A list of strings can be entered to select specific colourimetric data among the following: [&#39;dE76,&#39;dE00&#39;,&#39;dR_vis&#39;, &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;].</span>

<span class="sd">        xarray : bool, optional</span>
<span class="sd">            When True, the data are returned as an xarray.Dataset object, else as pandas dataframe object, by default False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        returns a list of pandas dataframes or xarray.Dataset objects</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">all_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">])</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[]</span> 
        <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[]</span> 

        <span class="k">for</span> <span class="n">data_file</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">:</span>

            <span class="n">sp</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span>            
            <span class="n">wl</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">He</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">Hv</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;t_sec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">L</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;L*&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;a*&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;b*&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">C</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;C*&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;h&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dE76</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;dE76&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dE00</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;dE00&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dR_vis</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;dR_vis&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="n">spectral_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s1">&#39;sp&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;wavelength&#39;</span><span class="p">,</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">sp</span><span class="p">)</span>                
                <span class="p">},</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span>
                    <span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="n">wl</span><span class="p">,</span>   
                    <span class="s1">&#39;dose&#39;</span><span class="p">:</span> <span class="n">He</span><span class="p">,</span>
                    <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">He</span><span class="p">),</span>
                    <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">Hv</span><span class="p">),</span>  <span class="c1"># Match radiant energy</span>
                    <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># Match radiant energy</span>
                <span class="p">}</span>
            <span class="p">)</span>

            <span class="n">color_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s1">&#39;L*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">L</span><span class="p">),</span>
                    <span class="s1">&#39;a*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">a</span><span class="p">),</span>
                    <span class="s1">&#39;b*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">b</span><span class="p">),</span>
                    <span class="s1">&#39;C*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">C</span><span class="p">),</span>
                    <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">h</span><span class="p">),</span>
                    <span class="s1">&#39;dE76&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE76</span><span class="p">),</span>
                    <span class="s1">&#39;dE00&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE00</span><span class="p">),</span>
                    <span class="s1">&#39;dR_vis&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dR_vis</span><span class="p">),</span>
                <span class="p">},</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span>                    
                    <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">He</span><span class="p">),</span>
                    <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">Hv</span><span class="p">),</span>
                    <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="p">)</span>                

            <span class="n">sp</span> <span class="o">=</span> <span class="n">spectral_data</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">([</span><span class="s2">&quot;He&quot;</span><span class="p">,</span><span class="s2">&quot;Hv&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">color_data</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">([</span><span class="s2">&quot;He&quot;</span><span class="p">,</span><span class="s2">&quot;Hv&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
            <span class="n">combined_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">sp</span><span class="p">,</span> <span class="n">cl</span><span class="p">])</span>

        <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>            


        <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="p">[</span><span class="n">data_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
                <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">data_sp</span><span class="p">,</span> <span class="n">data_cl</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">all_data</span>

        <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;sp&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="p">[</span><span class="n">data_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>                            
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">sp</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">data_sp</span>

        <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;cl&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;dE76&#39;</span><span class="p">,</span><span class="s1">&#39;dE00&#39;</span><span class="p">,</span><span class="s1">&#39;dR_vis&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">data_cl</span>

        <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;Lab&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">]])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">data_cl</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">dic_doses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">dic_doses</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dic_doses</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
                <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">data</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">elem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Hv&#39;</span><span class="p">,</span><span class="s1">&#39;He&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]]</span>
                <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">data</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">data_cl</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter a valid data parameter. It can either be a string (&#39;sp&#39;, &#39;cl&#39;, &#39;Lab&#39;, &#39;all&#39;) or a list of strings [&#39;dE00&#39;,&#39;dE76&#39;, &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;]&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>


    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the metadata.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        labels : Optional[list], optional</span>
<span class="sd">            A list of strings corresponding to the wanted metadata labels, by default &#39;all&#39;</span>
<span class="sd">            The metadata labels can be found in the &#39;info&#39; sheet of microfading excel files.</span>
<span class="sd">            When &#39;all&#39;, it returns all the metadata</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas dataframe</span>
<span class="sd">            It returns the metadata inside a pandas dataframe where each column corresponds to a single file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">()</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="p">]</span>

        <span class="n">df_metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">)</span>
            <span class="n">Id</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

            <span class="n">df_metadata</span><span class="p">[</span><span class="n">Id</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df_metadata</span>

        <span class="k">else</span><span class="p">:</span>            
            <span class="k">return</span> <span class="n">df_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">Lab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve the CIE L*a*b* values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        illuminant : (str, optional)  </span>
<span class="sd">            Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;D65&#39;.</span>

<span class="sd">        observer : (str|int, optional)</span>
<span class="sd">            Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;10&#39;.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas dataframe</span>
<span class="sd">            It returns the L*a*b* values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">observer</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

        <span class="n">illuminants</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D65&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D65&#39;</span><span class="p">],</span> <span class="s1">&#39;D50&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D50&#39;</span><span class="p">]}</span>
        <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
            <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
            <span class="p">}</span>

        <span class="n">ccs_ill</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>

        <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdev</span><span class="p">:</span>
            <span class="n">df_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>

        <span class="n">df_Lab</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>            
            <span class="n">Lab_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

                <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
                <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

                <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">illuminants</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span>        
                <span class="n">Lab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_Lab</span><span class="p">(</span><span class="n">XYZ</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="n">ccs_ill</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>               
                <span class="n">Lab_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Lab_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Lab</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">Lab_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Lab_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">Lab_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">Lab_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
            <span class="n">df_Lab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Lab_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_Lab</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">meas_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the measurement id numbers corresponding to the input files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>        
        <span class="k">return</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>


    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_data</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">criterion</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">folder</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute mean and standard deviation values of several microfading measurements.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        return_data : Optional[bool], optional</span>
<span class="sd">            Whether to return the data, by default True        </span>

<span class="sd">        criterion : Optional[str], optional</span>
<span class="sd">            _description_, by default &#39;group&#39;            </span>

<span class="sd">        save : Optional[bool], optional</span>
<span class="sd">            Whether to save the average data as an excel file, by default False</span>

<span class="sd">        folder : Optional[str], optional</span>
<span class="sd">            Folder where the excel file will be saved, by default &#39;default&#39;</span>
<span class="sd">            When &#39;default&#39;, the file will be saved in the same folder as the input files</span>
<span class="sd">            When &#39;.&#39;, the file will be saved in the current working directory</span>
<span class="sd">            One can also enter a valid path as a string.</span>

<span class="sd">        filename : Optional[str], optional</span>
<span class="sd">            Filename of the excel file containing the average values, by default &#39;default&#39;</span>
<span class="sd">            When &#39;default&#39;, it will use the filename of the first input file</span>
<span class="sd">            One can also enter a filename, but without a filename extension.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple, excel file</span>
<span class="sd">            It returns a tuple composed of three elements (info, CIELAB data, spectral data). When &#39;save&#39; is set to True, an excel is created to stored the tuple inside three distinct excel sheet (info, CIELAB, spectra).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>        
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Not enough files. At least two measurement files are required to compute the average values.&#39;</span><span class="p">)</span>


        <span class="k">def</span> <span class="nf">mean_std_with_nan</span><span class="p">(</span><span class="n">arrays</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&#39;&#39;&#39;Compute the mean of several numpy arrays of different shapes.&#39;&#39;&#39;</span>

            <span class="c1"># Find the maximum shape</span>
            <span class="n">max_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrays</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="c1"># Create arrays with NaN values</span>
            <span class="n">nan_arrays</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">max_shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arrays</span><span class="p">))]</span>

            <span class="c1"># Fill NaN arrays with actual values</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arrays</span><span class="p">):</span>
                <span class="n">nan_arrays</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">arr</span>

            <span class="c1"># Calculate mean</span>
            <span class="n">mean_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">nan_arrays</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="c1"># Calculate std</span>
            <span class="n">std_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">nan_arrays</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">mean_array</span><span class="p">,</span> <span class="n">std_array</span>


        <span class="k">def</span> <span class="nf">to_float</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span>


        <span class="c1">###### SPECTRAL DATA #######</span>

        <span class="n">data_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>

        <span class="c1"># Get the energy dose step</span>
        <span class="n">H_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>       
        <span class="n">step_H</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H_values</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">highest_He</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H_values</span><span class="p">])</span>

        <span class="c1"># Average the spectral data</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="n">mean_std_with_nan</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>
        <span class="n">sp_mean</span> <span class="o">=</span> <span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sp_std</span> <span class="o">=</span> <span class="n">sp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 


        <span class="c1"># Wanted energy dose values          </span>
        <span class="n">wanted_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">highest_He</span><span class="o">+</span><span class="n">step_H</span><span class="p">,</span><span class="n">step_H</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>  

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wanted_H</span><span class="p">)</span> <span class="o">!=</span> <span class="n">sp_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>            
            <span class="n">wanted_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">highest_He</span><span class="p">,</span><span class="n">sp_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Retrieve the wavelength range</span>
        <span class="n">wl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>


        <span class="c1"># Create a multi-index pandas DataFrame</span>
        <span class="n">H_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">dose</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span> <span class="k">for</span> <span class="n">dose</span> <span class="ow">in</span> <span class="n">wanted_H</span> <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]]</span>
        <span class="n">multiindex_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">H_tuples</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Measurement&#39;</span><span class="p">])</span>

        <span class="n">data_df_sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">wl</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wanted_H</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>       
        <span class="n">data_df_sp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp_mean</span>
        <span class="n">data_df_sp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp_std</span>
        <span class="n">df_sp_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_df_sp</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">multiindex_cols</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wl</span><span class="p">)</span>
        <span class="n">df_sp_final</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;wavelength_nm&#39;</span>



        <span class="c1">###### COLORIMETRIC DATA #######</span>

        <span class="n">data_cl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;dE&#39;</span><span class="p">)</span>
        <span class="n">columns_cl</span> <span class="o">=</span> <span class="n">data_cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>

        <span class="c1"># Average the colorimetric data    </span>
        <span class="n">cl</span> <span class="o">=</span> <span class="n">mean_std_with_nan</span><span class="p">(</span><span class="n">data_cl</span><span class="p">)</span>
        <span class="n">cl_mean</span> <span class="o">=</span> <span class="n">cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">cl_std</span> <span class="o">=</span> <span class="n">cl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Create a multi-index pandas DataFrame</span>
        <span class="n">cl_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]]</span>
        <span class="n">multiindex_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">cl_tuples</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;Measurement&#39;</span><span class="p">])</span>

        <span class="n">data_df_cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">cl_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cl_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>       
        <span class="n">data_df_cl</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_mean</span>
        <span class="n">data_df_cl</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_std</span>
        <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_df_cl</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">multiindex_cols</span><span class="p">,</span> <span class="p">)</span>
        <span class="n">df_cl_final</span><span class="o">.</span><span class="n">drop</span><span class="p">([(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)}</span>
        <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([</span><span class="n">mapper</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>


        <span class="n">cl_cols</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">cl_cols_level1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cl_cols</span><span class="p">]</span>
        <span class="n">cl_cols_level2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cl_cols</span><span class="p">]</span>
        <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">df_cl_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cl_cols_level2</span><span class="p">])),</span> <span class="n">df_cl_final</span><span class="p">])</span>
        <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cl_cols_level1</span>
        <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


        <span class="c1">###### INFO #######</span>

        <span class="n">data_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

        <span class="c1"># Select the first column as a template</span>
        <span class="n">df_info</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>


        <span class="c1"># Rename title file</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;[SINGLE MICRO-FADING ANALYSIS]&#39;</span><span class="p">:</span> <span class="s1">&#39;[MEAN MICRO-FADING ANALYSES]&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Date time</span>
        <span class="n">most_recent_dt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">most_recent_dt</span>

        <span class="c1"># Project data info</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;projectleider&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;projectleider&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meelezer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meelezer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;aanvraagdatum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;aanvraagdatum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;uiterste_datum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;uiterste_datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>

        <span class="c1"># Object data info</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_creator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_creator&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_support&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;binding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;binding&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;thickness_microns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;thickness_microns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>

        <span class="c1"># Device data info</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurement_mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurement_mode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;zoom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;zoom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;iris&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;iris&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_ill_mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_ill_mm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_coll_mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_coll_mm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))))</span>       

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_ref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>


        <span class="c1"># Analysis data info</span>

        <span class="n">criterion_value</span> <span class="o">=</span> <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">criterion</span><span class="p">]</span>
        <span class="n">object_id</span> <span class="o">=</span> <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;group&#39;</span><span class="p">:</span>            
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;MF.</span><span class="si">{</span><span class="n">object_id</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">criterion_value</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span> <span class="ow">or</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;project&#39;</span><span class="p">:</span>
             <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;MF.</span><span class="si">{</span><span class="n">criterion_value</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Choose one of the following options for the criterion parameter: [&quot;group&quot;, &quot;object&quot;, &quot;project&quot;]&#39;</span><span class="p">)</span>

        <span class="n">meas_nbs</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span><span class="p">])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">meas_nbs</span><span class="si">}</span><span class="s1">&#39;</span>    
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>  

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span> 


        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_ms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_ms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span> 
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;duration_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;duration_min&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;interval_sec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;interval_sec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurements_N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurements_N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>


        <span class="c1"># Beam data info</span>

        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;beam_photo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;beam_photo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;resolution_micron/pixel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;resolution_micron/pixel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))))</span>

        <span class="n">fwhm</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;FWHM_micron&#39;</span><span class="p">]</span>
        <span class="n">fwhm_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">to_float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fwhm</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;FWHM_micron&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fwhm_avg</span>

        <span class="n">power_info</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;power_mW&#39;</span><span class="p">]</span>
        <span class="n">power_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">power_info</span><span class="p">])</span>
        <span class="n">power_ids</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">power_info</span><span class="p">])))</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;power_mW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">power_ids</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">power_avg</span><span class="si">}</span><span class="s1">&#39;</span> 

        <span class="n">irr_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ufloat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;irradiance_W/m**2&#39;</span><span class="p">]</span> <span class="p">]</span> 
        <span class="n">irr_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">irr_values</span><span class="p">]))</span>
        <span class="n">irr_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">([</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">irr_values</span><span class="p">]))</span>
        <span class="n">irr_avg</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">irr_mean</span><span class="p">,</span> <span class="n">irr_std</span><span class="p">)</span>    
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;irradiance_W/m**2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">irr_avg</span>

        <span class="n">lm</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;luminuous_flux_lm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
        <span class="n">lm_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lm</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;luminuous_flux_lm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lm_avg</span>

        <span class="n">ill</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminance_Mlx&#39;</span><span class="p">]]</span>
        <span class="n">ill_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ill</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminance_Mlx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill_avg</span>


        <span class="c1"># Results data info</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;totalDose_He_MJ/m**2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;totalDose_Hv_Mlxh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fittedEqHe_dE00&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fittedEqHv_dE00&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fittedRate_dE00_at_2Mlxh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fittedRate_dE00_at_20MJ/m**2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dE00_at_300klxh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dE00_at_3MJ/m**2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dEab_final&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dE76&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dE76&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dE00_final&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dR_VIS_final&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dR_vis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dR_vis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Hv_at_1dE00&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;BWSE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># Rename the column</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span>


        <span class="c1">###### SAVE THE MEAN DATAFRAMES #######</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>  

            <span class="c1"># set the folder</span>
            <span class="k">if</span> <span class="n">folder</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span>
                <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>  

            <span class="k">elif</span> <span class="n">folder</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">parent</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>         

            <span class="c1"># set the filename</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s1">_MEAN</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s1">&#39;</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">.xlsx&#39;</span>


            <span class="c1"># create a excel writer object</span>
            <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">folder</span> <span class="o">/</span> <span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>

                <span class="n">df_info</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">df_cl_final</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;CIELAB&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">df_sp_final</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


        <span class="c1">###### RETURN THE MEAN DATAFRAMES #######</span>

        <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl_final</span><span class="p">,</span> <span class="n">df_sp_final</span>


    <span class="k">def</span> <span class="nf">plot_sp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stds</span><span class="o">=</span><span class="p">[],</span> <span class="n">spectra</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">fontsize_legend</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">26</span><span class="p">,</span> <span class="n">wl_range</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth_params</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">report</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the reflectance spectra corresponding to the associated microfading analyses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stds : list, optional</span>
<span class="sd">             A list of standard variation values respective to each element given in the data parameter, by default []</span>

<span class="sd">        spectra : Optional[str], optional</span>
<span class="sd">            Define which spectra to display, by default &#39;i&#39;</span>
<span class="sd">            Use &#39;i&#39; for initial spectral, &#39;f&#39; for final spectra, &#39;i+f&#39; for initial and final spectra, or &#39;all&#39; for all the spectra.</span>

<span class="sd">        labels : Union[str, list], optional</span>
<span class="sd">            _description_, by default &#39;default&#39;</span>

<span class="sd">        title : str, optional</span>
<span class="sd">            Whether to add a title to the plot, by default None</span>

<span class="sd">        fontsize : int, optional</span>
<span class="sd">            Fontsize of the plot (title, ticks, and labels), by default 24</span>

<span class="sd">        fontsize_legend : int, optional</span>
<span class="sd">            Fontsize of the legend, by default 26</span>

<span class="sd">        wl_range : tuple, optional</span>
<span class="sd">            Define the wavelength range, by default None</span>

<span class="sd">        colors : Union[str, list], optional</span>
<span class="sd">            Define the colors of the reflectance curves, by default None</span>
<span class="sd">            When &#39;sample&#39;, the color of each line will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) or a list of matplotlib colour values can be used. </span>

<span class="sd">        lw : Union[int, list], optional</span>
<span class="sd">            Define the width of the plot lines, by default 2</span>
<span class="sd">            It can be a single integer value that will apply to all the curves. Or a list of integers can be used where the number of integer elements should match the number of reflectance curves.</span>

<span class="sd">        ls : Union[str, list], optional</span>
<span class="sd">            Define the line style of the plot lines, by default &#39;-&#39;</span>
<span class="sd">            It can be a string (&#39;-&#39;, &#39;--&#39;, &#39;:&#39;, &#39;-.&#39;) that will apply to all the curves. Or a list of string can be used where the number of string elements should match the number of reflectance curves.</span>

<span class="sd">        save : bool, optional</span>
<span class="sd">            Whether to save the figure, by default False</span>

<span class="sd">        path_fig : str, optional</span>
<span class="sd">            Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">            When &#39;cwd&#39;, it will save the figure in the current working directory.</span>

<span class="sd">        derivation : bool, optional</span>
<span class="sd">            Wether to compute and display the first derivative values of the spectra, by default False</span>

<span class="sd">        smooth : bool, optional</span>
<span class="sd">            Whether to smooth the reflectance curves, by default False</span>

<span class="sd">        smooth_params : list, optional</span>
<span class="sd">            Parameters related to the Savitzky-Golay filter, by default [10,1]</span>
<span class="sd">            Enter a list of two integers where the first value corresponds to the window_length and the second to the polyorder value. </span>

<span class="sd">        report : Optional[bool], optional</span>
<span class="sd">            _description_, by default False</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _type_</span>
<span class="sd">            _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Retrieve the data</span>
        <span class="n">data_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>
        <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>        
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span> 


        <span class="c1"># Whether to smooth the data</span>
        <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
                <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="n">smooth_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polyorder</span><span class="o">=</span><span class="n">smooth_params</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">idx</span><span class="p">,</span><span class="n">cols</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data_sp</span><span class="p">,</span><span class="n">indices</span><span class="p">,</span><span class="n">columns</span><span class="p">)]</span>       

        <span class="c1"># Reset the index</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>

        <span class="c1"># Whether to compute the first derivative</span>
        <span class="k">if</span> <span class="n">derivation</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

        <span class="c1"># Retrieve the metadata</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
        <span class="n">object_info</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">object_technique</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">group_nb</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">group_descriptions</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">group_description</span> <span class="o">=</span> <span class="n">group_descriptions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span> <span class="k">if</span> <span class="s1">&#39;BW&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="n">meas_nbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>

        <span class="c1"># Select which spectra to plot </span>
        <span class="k">if</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>            
            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Initial spectra&#39;</span>

        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>             
            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Final spectra&#39;</span>          

        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s2">&quot;i+f&quot;</span><span class="p">:</span>
            <span class="n">list_data</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">l1</span> <span class="ow">in</span> <span class="n">list_data</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">l2</span> <span class="ow">in</span> <span class="n">l1</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>

            <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">lw</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">colors</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">meas_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">meas_nbs</span><span class="p">,</span><span class="n">group_descriptions</span><span class="p">)]</span>
            <span class="n">none_labels</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas_labels</span><span class="p">)</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">none_labels</span><span class="p">,</span> <span class="n">meas_labels</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">]</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Initial (black dashed lines) and final spectra&#39;</span>

        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span> <span class="p">:</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">data_sp</span>
            <span class="p">]</span>
            <span class="c1">#data = [(x.iloc[:,0].values, x.iloc[:,1:].values) for x in data]            </span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;All spectra&#39;</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="kc">None</span>


        <span class="k">return</span> <span class="n">plotting</span><span class="o">.</span><span class="n">spectra</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">stds</span><span class="o">=</span><span class="p">[],</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">fontsize_legend</span><span class="o">=</span><span class="n">fontsize_legend</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="n">derivation</span><span class="p">)</span>



    <span class="k">def</span> <span class="nf">set_illuminant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the illuminant values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        illuminant : Optional[str], optional</span>
<span class="sd">            Select the illuminant, by default &#39;D65&#39;</span>
<span class="sd">            It can be any value within the following list: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D50&#39;, &#39;D55&#39;, &#39;D60&#39;, &#39;D65&#39;, &#39;D75&#39;, &#39;E&#39;, &#39;FL1&#39;, &#39;FL2&#39;, &#39;FL3&#39;, &#39;FL4&#39;, &#39;FL5&#39;, &#39;FL6&#39;, &#39;FL7&#39;, &#39;FL8&#39;, &#39;FL9&#39;, &#39;FL10&#39;, &#39;FL11&#39;, &#39;FL12&#39;, &#39;FL3.1&#39;, &#39;FL3.2&#39;, &#39;FL3.3&#39;, &#39;FL3.4&#39;, &#39;FL3.5&#39;, &#39;FL3.6&#39;, &#39;FL3.7&#39;, &#39;FL3.8&#39;, &#39;FL3.9&#39;, &#39;FL3.10&#39;, &#39;FL3.11&#39;, &#39;FL3.12&#39;, &#39;FL3.13&#39;, &#39;FL3.14&#39;, &#39;FL3.15&#39;, &#39;HP1&#39;, &#39;HP2&#39;, &#39;HP3&#39;, &#39;HP4&#39;, &#39;HP5&#39;, &#39;LED-B1&#39;, &#39;LED-B2&#39;, &#39;LED-B3&#39;, &#39;LED-B4&#39;, &#39;LED-B5&#39;, &#39;LED-BH1&#39;, &#39;LED-RGB1&#39;, &#39;LED-V1&#39;, &#39;LED-V2&#39;, &#39;ID65&#39;, &#39;ID50&#39;, &#39;ISO 7589 Photographic Daylight&#39;, &#39;ISO 7589 Sensitometric Daylight&#39;, &#39;ISO 7589 Studio Tungsten&#39;, &#39;ISO 7589 Sensitometric Studio Tungsten&#39;, &#39;ISO 7589 Photoflood&#39;, &#39;ISO 7589 Sensitometric Photoflood&#39;, &#39;ISO 7589 Sensitometric Printer&#39;]</span>

<span class="sd">        observer : Optional[str], optional</span>
<span class="sd">            Standard observer in degree, by default &#39;10&#39;</span>
<span class="sd">            It can be either &#39;2&#39; or &#39;10&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            It returns a tuple with two set of values: the chromaticity coordinates of the illuminants (CCS) and the spectral distribution of the illuminants (SDS).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s2">&quot;cie_10_1964&quot;</span><span class="p">,</span>
            <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s2">&quot;cie_2_1931&quot;</span>
        <span class="p">}</span>

        <span class="n">CCS</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>
        <span class="n">SDS</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">CCS</span><span class="p">,</span> <span class="n">SDS</span>


    <span class="k">def</span> <span class="nf">set_observer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the observer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        observer : Optional[str], optional</span>
<span class="sd">            Standard observer in degree, by default &#39;10&#39;</span>
<span class="sd">            It can be either &#39;2&#39; or &#39;10&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------        </span>
<span class="sd">            Returns the x_bar,  y_bar, z_bar spectra between 360 and 830 nm.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">,</span>
            <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]]</span>


    <span class="k">def</span> <span class="nf">sp_derivation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the first derivative values of reflectance spectra.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        a list of pandas dataframes</span>
<span class="sd">            It returns the first derivative values of the reflectance spectra inside dataframes where each column corresponds to a single spectra.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>                    

        <span class="n">sp_derivation</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sp</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">sp_derivation</span>


    <span class="k">def</span> <span class="nf">sRGB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the sRGB values. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        illuminant : (str, optional)  </span>
<span class="sd">            Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;D65&#39;.</span>

<span class="sd">        observer : (str|int, optional)</span>
<span class="sd">            Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;10&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas dataframe</span>
<span class="sd">            It returns the sRGB values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">observer</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

        <span class="n">illuminants</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D65&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D65&#39;</span><span class="p">],</span> <span class="s1">&#39;D50&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D50&#39;</span><span class="p">]}</span>
        <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
            <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
            <span class="p">}</span>

        <span class="n">ccs_ill</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>

        <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span>                
        <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>       
        <span class="n">df_srgb</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

            <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

                <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
                <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

                <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">illuminants</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span> 
                <span class="n">srgb</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_sRGB</span><span class="p">(</span><span class="n">XYZ</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">ccs_ill</span><span class="p">)</span>                          
                <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">srgb_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">srgb</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">srgb_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">srgb_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">srgb_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">srgb_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
            <span class="n">df_srgb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">srgb_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_srgb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wavelength</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the wavelength range of the microfading measurements.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>

        <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">wavelengths</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span>

        <span class="k">return</span> <span class="n">wavelengths</span>


    <span class="k">def</span> <span class="nf">XYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the XYZ values. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        illuminant : (str, optional)  </span>
<span class="sd">            Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;D65&#39;.</span>

<span class="sd">        observer : (str|int, optional)</span>
<span class="sd">            Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;10&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas dataframe</span>
<span class="sd">            It returns the XYZ values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">observer</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

        <span class="n">illuminants</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D65&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D65&#39;</span><span class="p">],</span> <span class="s1">&#39;D50&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D50&#39;</span><span class="p">]}</span>

        <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
            <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
            <span class="p">}</span>

        <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span>                
        <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>       
        <span class="n">df_XYZ</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

            <span class="n">XYZ_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

                <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
                <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

                <span class="n">XYZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">illuminants</span><span class="p">[</span><span class="n">illuminant</span><span class="p">]),</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">XYZ_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">XYZ_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">XYZ</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">XYZ_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">XYZ_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">XYZ_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">XYZ_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
            <span class="n">df_XYZ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZ_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_XYZ</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the xy values. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        illuminant : (str, optional)  </span>
<span class="sd">            Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;D65&#39;.</span>

<span class="sd">        observer : (str|int, optional)</span>
<span class="sd">            Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;10&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas dataframe</span>
<span class="sd">            It returns the xy values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="n">observer</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

        <span class="n">illuminants</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D65&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D65&#39;</span><span class="p">],</span> <span class="s1">&#39;D50&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D50&#39;</span><span class="p">]}</span>
        <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
            <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
            <span class="p">}</span>

        <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span>                
        <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>       
        <span class="n">df_xy</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

            <span class="n">xy_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

                <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
                <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

                <span class="n">XYZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">illuminants</span><span class="p">[</span><span class="n">illuminant</span><span class="p">]),</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_xy</span><span class="p">(</span><span class="n">XYZ</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
                <span class="n">xy_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">xy_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">xy_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">xy_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">xy_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">xy_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
            <span class="n">df_xy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_xy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>





















        <span class="n">observer</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

        <span class="n">illuminants</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D65&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D65&#39;</span><span class="p">],</span> <span class="s1">&#39;D50&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D50&#39;</span><span class="p">]}</span>
        <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
            <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
            <span class="p">}</span>

        <span class="n">df_xy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]))</span>
        <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>
        <span class="n">wl</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">index</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">df_sp</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>

            <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">illuminants</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span> 
            <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_xy</span><span class="p">(</span><span class="n">XYZ</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>

            <span class="n">df_xy</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">xy</span>

        <span class="k">return</span> <span class="n">df_xy</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="microfading.microfading.MFT.meas_ids" class="doc doc-heading">
            <code class=" language-python"><span class="n">meas_ids</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#microfading.microfading.MFT.meas_ids" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the measurement id numbers corresponding to the input files.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="microfading.microfading.MFT.wavelength" class="doc doc-heading">
            <code class=" language-python"><span class="n">wavelength</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#microfading.microfading.MFT.wavelength" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the wavelength range of the microfading measurements.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.Lab" class="doc doc-heading">
            <code class=" language-python"><span class="n">Lab</span><span class="p">(</span><span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.Lab" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the CIE L<em>a</em>b* values.</p>
<h5 id="microfading.microfading.MFT.Lab--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.Lab--parameters" title="Permanent link">&para;</a></h5>
<p>illuminant : (str, optional)<br />
    Reference <em>illuminant</em> ('D65', or 'D50'). by default 'D65'.</p>


<details class="observer-" open>
  <summary>(str|int, optional)</summary>
  <p>Reference <em>observer</em> in degree ('10' or '2'). by default '10'.</p>
</details>        <h5 id="microfading.microfading.MFT.Lab--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.Lab--returns" title="Permanent link">&para;</a></h5>
<p>pandas dataframe
    It returns the L<em>a</em>b* values inside a dataframe where each column corresponds to a single file.</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">Lab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the CIE L*a*b* values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    illuminant : (str, optional)  </span>
<span class="sd">        Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;D65&#39;.</span>

<span class="sd">    observer : (str|int, optional)</span>
<span class="sd">        Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;10&#39;.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the L*a*b* values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">    &quot;&quot;&quot;</span>        
    <span class="n">observer</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

    <span class="n">illuminants</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D65&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D65&#39;</span><span class="p">],</span> <span class="s1">&#39;D50&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D50&#39;</span><span class="p">]}</span>
    <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
        <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
        <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
        <span class="p">}</span>

    <span class="n">ccs_ill</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>

    <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdev</span><span class="p">:</span>
        <span class="n">df_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>

    <span class="n">df_Lab</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>            
        <span class="n">Lab_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

            <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">illuminants</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span>        
            <span class="n">Lab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_Lab</span><span class="p">(</span><span class="n">XYZ</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="n">ccs_ill</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>               
            <span class="n">Lab_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Lab_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Lab</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">Lab_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Lab_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">Lab_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">Lab_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
        <span class="n">df_Lab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Lab_values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_Lab</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.XYZ" class="doc doc-heading">
            <code class=" language-python"><span class="n">XYZ</span><span class="p">(</span><span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.XYZ" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the XYZ values. </p>
<h5 id="microfading.microfading.MFT.XYZ--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.XYZ--parameters" title="Permanent link">&para;</a></h5>
<p>illuminant : (str, optional)<br />
    Reference <em>illuminant</em> ('D65', or 'D50'). by default 'D65'.</p>


<details class="observer-" open>
  <summary>(str|int, optional)</summary>
  <p>Reference <em>observer</em> in degree ('10' or '2'). by default '10'.</p>
</details>        <h5 id="microfading.microfading.MFT.XYZ--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.XYZ--returns" title="Permanent link">&para;</a></h5>
<p>pandas dataframe
    It returns the XYZ values inside a dataframe where each column corresponds to a single file.</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">XYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the XYZ values. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    illuminant : (str, optional)  </span>
<span class="sd">        Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;D65&#39;.</span>

<span class="sd">    observer : (str|int, optional)</span>
<span class="sd">        Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;10&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the XYZ values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">observer</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

    <span class="n">illuminants</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D65&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D65&#39;</span><span class="p">],</span> <span class="s1">&#39;D50&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D50&#39;</span><span class="p">]}</span>

    <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
        <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
        <span class="p">}</span>

    <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span>                
    <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>       
    <span class="n">df_XYZ</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

        <span class="n">XYZ_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

            <span class="n">XYZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">illuminants</span><span class="p">[</span><span class="n">illuminant</span><span class="p">]),</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">XYZ_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">XYZ_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">XYZ</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">XYZ_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">XYZ_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">XYZ_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">XYZ_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
        <span class="n">df_XYZ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZ_values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_XYZ</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">BWS</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stdev</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Instantiate a Microfading (MFT) class object in order to manipulate and visualize microfading analysis data.</p>
<h5 id="microfading.microfading.MFT.__init__--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.__init__--parameters" title="Permanent link">&para;</a></h5>
<p>files : list
    A list of string, where each string corresponds to the absolute path of text or csv file that contains the data and metadata of a single microfading measurement. The content of the file requires a specific structure, for which an example can be found in "datasets" folder of the microfading package folder (Use the get_datasets function to retrieve the precise location of such example files). If the file structure is not respected, the script will not be able to properly read the file and access its content.</p>


<details class="bws-" open>
  <summary>bool, optional</summary>
  <p>When False, it ignores the measurements performed on BWS samples if included. </p>
</details>

<details class="stdev" open>
  <summary>bool, optional</summary>
  <p>Indicate whether the input files contains standard deviation values, by default False</p>
</details>
            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">BWS</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">stdev</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate a Microfading (MFT) class object in order to manipulate and visualize microfading analysis data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    files : list</span>
<span class="sd">        A list of string, where each string corresponds to the absolute path of text or csv file that contains the data and metadata of a single microfading measurement. The content of the file requires a specific structure, for which an example can be found in &quot;datasets&quot; folder of the microfading package folder (Use the get_datasets function to retrieve the precise location of such example files). If the file structure is not respected, the script will not be able to properly read the file and access its content.</span>

<span class="sd">    BWS : bool, optional</span>
<span class="sd">        When False, it ignores the measurements performed on BWS samples if included. </span>

<span class="sd">    stdev: bool, optional</span>
<span class="sd">        Indicate whether the input files contains standard deviation values, by default False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="n">files</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">BWS</span> <span class="o">=</span> <span class="n">BWS</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stdev</span> <span class="o">=</span> <span class="n">stdev</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BWS</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="k">if</span> <span class="s1">&#39;BW&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.data_points" class="doc doc-heading">
            <code class=" language-python"><span class="n">data_points</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.data_points" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Select colourimetric values for one or multiple light dose values.</p>
<h5 id="microfading.microfading.MFT.data_points--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.data_points--parameters" title="Permanent link">&para;</a></h5>
<p>coordinates : Optional[list], optional
    Select the desired colourimetric coordinates from the following list: ['L<em>', 'a</em>','b<em>', 'C</em>', 'h', 'dL<em>', 'da</em>','db<em>', 'dC</em>', 'dh', 'dE76', 'dE00', 'dR_vis'], by default ['dE00']</p>


<details class="dose_unit-" open>
  <summary>Optional[str], optional</summary>
  <p>Select the unit of the light energy, by default ['He']
Any of the following units can be added to the list: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="dose_values-" open>
  <summary>Union[int, float, list, tuple], optional</summary>
  <p>Select the values of the light energy, by default 1
A single value, a list of multiple values, or range values with a tuple (start, end, step) can be entered.</p>
</details>

<details class="index-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to set the index of the returned dataframes, by default False</p>
</details>        <h5 id="microfading.microfading.MFT.data_points--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.data_points--returns" title="Permanent link">&para;</a></h5>
<p>A list of pandas dataframes
    It returns the values of the wanted colour coordinates inside dataframes where each coordinate corresponds to a column.</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">data_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">dose_values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Select colourimetric values for one or multiple light dose values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coordinates : Optional[list], optional</span>
<span class="sd">        Select the desired colourimetric coordinates from the following list: [&#39;L*&#39;, &#39;a*&#39;,&#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;, &#39;dL*&#39;, &#39;da*&#39;,&#39;db*&#39;, &#39;dC*&#39;, &#39;dh&#39;, &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39;], by default [&#39;dE00&#39;]</span>

<span class="sd">    dose_unit : Optional[str], optional</span>
<span class="sd">        Select the unit of the light energy, by default [&#39;He&#39;]</span>
<span class="sd">        Any of the following units can be added to the list: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    dose_values : Union[int, float, list, tuple], optional</span>
<span class="sd">        Select the values of the light energy, by default 1</span>
<span class="sd">        A single value, a list of multiple values, or range values with a tuple (start, end, step) can be entered.</span>

<span class="sd">    index : Optional[bool], optional</span>
<span class="sd">        Whether to set the index of the returned dataframes, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A list of pandas dataframes</span>
<span class="sd">        It returns the values of the wanted colour coordinates inside dataframes where each coordinate corresponds to a column.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Retrieve the range light dose values</span>
    <span class="n">doses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
        <span class="n">dose_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">dose_values</span><span class="p">]</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">dose_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dose_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dose_values</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dose_values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">dose_values</span> <span class="o">=</span> <span class="n">dose_values</span>        

    <span class="c1"># Retrieve the data</span>
    <span class="n">original_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;cl&#39;</span><span class="p">)</span>

    <span class="c1"># Added the delta LabCh values to the data dataframes   </span>
    <span class="k">if</span> <span class="n">original_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

        <span class="n">delta_coord</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">unumpy</span><span class="o">.</span><span class="n">uarray</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">original_data</span><span class="p">]</span>

        <span class="n">delta_means</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">delta_coord</span><span class="p">]</span>
        <span class="n">delta_stds</span> <span class="o">=</span> <span class="p">[</span><span class="n">unumpy</span><span class="o">.</span><span class="n">std_devs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">delta_coord</span><span class="p">]</span>

        <span class="n">delta_coord_mean</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]]</span>
        <span class="n">delta_coord_std</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]]</span>

        <span class="c1"># Add the new columns to the dictionary</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">original_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">coord_mean</span><span class="p">,</span><span class="n">delta_mean</span><span class="p">,</span><span class="n">coord_std</span><span class="p">,</span><span class="n">delta_std</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">delta_coord_mean</span><span class="p">,</span><span class="n">delta_means</span><span class="p">,</span> <span class="n">delta_coord_std</span><span class="p">,</span><span class="n">delta_stds</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">coord_mean</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">delta_mean</span><span class="p">))</span>
                <span class="n">d</span><span class="p">[</span><span class="n">coord_mean</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_mean</span>
                <span class="n">d</span><span class="p">[</span><span class="n">coord_std</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta_std</span>

            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>


        <span class="c1"># Select the wanted dose_unit and coordinate        </span>
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="n">doses</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]]</span> <span class="o">+</span> <span class="n">coordinates</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>        
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]})</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">original_data</span><span class="p">]</span>

        <span class="c1"># Select the wanted dose_unit and coordinate        </span>
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="n">doses</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">]]</span> <span class="o">+</span> <span class="n">coordinates</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>        
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>

    <span class="c1"># Interpolation function, assuming linear interpolation</span>
    <span class="n">interp_functions</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Double comprehension list to interpolate each dataframe in wanted_data</span>
    <span class="n">interpolated_data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="n">col</span><span class="p">:</span> <span class="n">interp_functions</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])(</span><span class="n">dose_values</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dose_values</span><span class="p">)</span>
        <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">doses</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">])</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">wanted_data</span>
    <span class="p">]</span>

    <span class="c1"># Whether to set the index</span>
    <span class="k">if</span> <span class="n">index</span><span class="p">:</span>
        <span class="n">interpolated_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">interpolated_data</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">interpolated_data</span>       
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.delta" class="doc doc-heading">
            <code class=" language-python"><span class="n">delta</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;He&#39;</span><span class="p">],</span> <span class="n">rate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.delta" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the CIE delta values for a given set of colorimetric coordinates corresponding to the given microfading analyses.</p>
<h5 id="microfading.microfading.MFT.delta--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.delta--parameters" title="Permanent link">&para;</a></h5>
<p>coordinates : list, optional
    List of colorimetric coordinates, by default ['dE00']
    Any of the following coordinates can be added to the list: 'dE76', 'dE00', 'dR_vis' , 'L<em>', 'a</em>', 'b<em>', 'C</em>', 'h'.</p>


<details class="dose_unit-" open>
  <summary>list, optional</summary>
  <p>List of light energy doses, by default ['He']
Any of the following units can be added to the list: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="rate-" open>
  <summary>bool, optional</summary>
  <p>Whether to return the first derivative values of the desired coordinates, by default False</p>
</details>        <h5 id="microfading.microfading.MFT.delta--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.delta--returns" title="Permanent link">&para;</a></h5>
<p><em>type</em>
    Returns a Pandas dataframe where each column corresponds to a desired coordinate or light energy dose.</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">],</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;He&#39;</span><span class="p">],</span> <span class="n">rate</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the CIE delta values for a given set of colorimetric coordinates corresponding to the given microfading analyses.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coordinates : list, optional</span>
<span class="sd">        List of colorimetric coordinates, by default [&#39;dE00&#39;]</span>
<span class="sd">        Any of the following coordinates can be added to the list: &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39; , &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;.</span>

<span class="sd">    dose_unit : list, optional</span>
<span class="sd">        List of light energy doses, by default [&#39;He&#39;]</span>
<span class="sd">        Any of the following units can be added to the list: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    rate : bool, optional</span>
<span class="sd">        Whether to return the first derivative values of the desired coordinates, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    _type_</span>
<span class="sd">        Returns a Pandas dataframe where each column corresponds to a desired coordinate or light energy dose.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">doses_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span> 
    <span class="n">doses_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">doses_dic</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dose_unit</span><span class="p">]</span>

    <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdev</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span> 

        <span class="n">doses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">doses_labels</span><span class="p">)</span> 
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">coordinates</span><span class="p">)</span>        


        <span class="k">for</span> <span class="n">el_data</span><span class="p">,</span><span class="n">el_dose</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">doses</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">el_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">]:</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">el_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                    <span class="n">values_delta</span> <span class="o">=</span> <span class="n">values</span> <span class="o">-</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   

                    <span class="n">el_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_delta</span>
                    <span class="n">el_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">col</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">rate</span><span class="p">:</span>   

                <span class="n">step_dose</span> <span class="o">=</span> <span class="n">el_dose</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">el_dose</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">el_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">el_data</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">step_dose</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">el_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

            <span class="n">wanted_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">el_dose</span><span class="p">,</span> <span class="n">el_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>


    <span class="k">else</span><span class="p">:</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">coordinates</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">coordinates</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
        <span class="n">doses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">doses_labels</span><span class="p">)</span>
        <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">doses</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>

        <span class="n">new_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">]:</span>
                    <span class="n">new_columns</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

            <span class="n">i</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">new_columns</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">i</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>          


    <span class="k">return</span> <span class="n">wanted_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.fit_data" class="doc doc-heading">
            <code class=" language-python"><span class="n">fit_data</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dose_unit</span><span class="o">=</span><span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">coordinate</span><span class="o">=</span><span class="s1">&#39;dE00&#39;</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="s1">&#39;c0*(x**c1)&#39;</span><span class="p">,</span> <span class="n">initial_params</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1001</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.fit_data" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fit the values of a given colourimetric coordinates. </p>
<h5 id="microfading.microfading.MFT.fit_data--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.fit_data--parameters" title="Permanent link">&para;</a></h5>
<p>plot : bool, optional
    Whether to show the fitted data, by default False</p>


<details class="return_data-" open>
  <summary>bool, optional</summary>
  <p>Whether to return the fitted data, by default False</p>
</details>

<details class="dose_unit-" open>
  <summary>string, optional</summary>
  <p>Select the light energy dose, by default 'He'
Any of the following units can be used: 'He', 'Hv', 't'. Where 'He' corresponds to radiant energy (MJ/m2), 'Hv' to exposure dose (Mlxh), and 't' to times (sec)</p>
</details>

<details class="coordinates-" open>
  <summary>string, optional</summary>
  <p>Select the desired colourimetric coordinates from the following list: ['L<em>', 'a</em>','b<em>', 'C</em>', 'h', 'dL<em>', 'da</em>','db<em>', 'dC</em>', 'dh', 'dE76', 'dE00', 'dR_vis'], by default 'dE00'</p>
</details>

<details class="equation-" open>
  <summary>str, optional</summary>
  <p>Mathematical equation used to fit the coordinate values, by default 'c0<em>(x</em>*c1)'</p>
</details>

<details class="initial_params-" open>
  <summary>Optional[List[float]], optional</summary>
  <p>Initial guesses of the 'c' parameters given in the equation (c0, c1, c2, etc.), by default [0.1, 0.0]</p>
</details>

<details class="x_range-" open>
  <summary>Optional[Tuple[int]], optional</summary>
  <p>Values along which the fitted values should be computed (start, end, step), by default (0, 1001, 1)</p>
</details>

<details class="save-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to save the plot, by default False</p>
</details>

<details class="path_fig-" open>
  <summary>Optional[str], optional</summary>
  <p>Absolute path of the figure to be saved, by default 'default'</p>
</details>        <h5 id="microfading.microfading.MFT.fit_data--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.fit_data--returns" title="Permanent link">&para;</a></h5>
<p>Union[None, Tuple[np.ndarray, np.ndarray]]
    <em>description</em></p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_data</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">dose_unit</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;dE00&#39;</span><span class="p">,</span> <span class="n">equation</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;c0*(x**c1)&#39;</span><span class="p">,</span> <span class="n">initial_params</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">x_range</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1001</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">save</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fit the values of a given colourimetric coordinates. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plot : bool, optional</span>
<span class="sd">        Whether to show the fitted data, by default False</span>

<span class="sd">    return_data : bool, optional</span>
<span class="sd">        Whether to return the fitted data, by default False</span>

<span class="sd">    dose_unit : string, optional</span>
<span class="sd">        Select the light energy dose, by default &#39;He&#39;</span>
<span class="sd">        Any of the following units can be used: &#39;He&#39;, &#39;Hv&#39;, &#39;t&#39;. Where &#39;He&#39; corresponds to radiant energy (MJ/m2), &#39;Hv&#39; to exposure dose (Mlxh), and &#39;t&#39; to times (sec)</span>

<span class="sd">    coordinates : string, optional</span>
<span class="sd">        Select the desired colourimetric coordinates from the following list: [&#39;L*&#39;, &#39;a*&#39;,&#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;, &#39;dL*&#39;, &#39;da*&#39;,&#39;db*&#39;, &#39;dC*&#39;, &#39;dh&#39;, &#39;dE76&#39;, &#39;dE00&#39;, &#39;dR_vis&#39;], by default &#39;dE00&#39;</span>

<span class="sd">    equation : str, optional</span>
<span class="sd">        Mathematical equation used to fit the coordinate values, by default &#39;c0*(x**c1)&#39;</span>

<span class="sd">    initial_params : Optional[List[float]], optional</span>
<span class="sd">        Initial guesses of the &#39;c&#39; parameters given in the equation (c0, c1, c2, etc.), by default [0.1, 0.0]</span>

<span class="sd">    x_range : Optional[Tuple[int]], optional</span>
<span class="sd">        Values along which the fitted values should be computed (start, end, step), by default (0, 1001, 1)</span>

<span class="sd">    save : Optional[bool], optional</span>
<span class="sd">        Whether to save the plot, by default False</span>

<span class="sd">    path_fig : Optional[str], optional</span>
<span class="sd">        Absolute path of the figure to be saved, by default &#39;default&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[None, Tuple[np.ndarray, np.ndarray]]</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Retrieve the range light dose values</span>
    <span class="n">doses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>  
    <span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">*</span><span class="n">x_range</span><span class="p">)</span>

    <span class="c1"># Retrieve the data</span>
    <span class="n">original_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;cl&#39;</span><span class="p">)</span>

    <span class="c1">#original_data = self.get_data(data=&#39;dE&#39;) if self.data_category == &#39;interim&#39; else self.get_data(data=&#39;dE&#39;)[0].astype(float)</span>

    <span class="c1"># Added the delta LabCh values to the data dataframes</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span> <span class="s1">&#39;a*&#39;</span><span class="p">,</span> <span class="s1">&#39;b*&#39;</span><span class="p">,</span> <span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">})</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">original_data</span><span class="p">]</span>

    <span class="c1"># Select the wanted dose_unit and coordinate</span>
    <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="n">doses</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="n">coordinate</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
    <span class="n">wanted_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">]</span>

    <span class="c1"># Define the function to fit</span>
    <span class="k">def</span> <span class="nf">fit_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
        <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;c</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">param</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">params</span><span class="p">)}</span>
        <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">equation</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="n">param_dict</span><span class="p">)</span>

    <span class="c1"># Define boundaries for the parameters</span>
    <span class="c1">#bounds = ([-np.inf] * len(initial_params), [np.inf, 1]) if len(initial_params) == 2 else ([-np.inf] * len(initial_params), [np.inf, 1, np.inf])</span>

    <span class="c1"># Create an empty dataframe for the fitted data</span>
    <span class="n">fitted_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x_values</span><span class="p">))</span>

    <span class="c1"># Empty list to store the labels</span>
    <span class="n">fitted_labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Emtpy list to store the optimized parameters</span>
    <span class="n">fitted_parameters</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">wanted_data</span><span class="p">:</span>
        <span class="c1"># retrieve the x(light dose) and y(coordinate) values</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># perform the curve fitting</span>
        <span class="n">optimized_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">fit_function</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">initial_params</span><span class="p">,</span> <span class="p">)</span> <span class="c1"># bounds=bounds</span>

        <span class="c1"># generate fitted y data</span>
        <span class="n">fitted_y</span> <span class="o">=</span> <span class="n">fit_function</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="o">*</span><span class="n">optimized_params</span><span class="p">)</span>

        <span class="c1"># append it to the fitted_data dataframe</span>
        <span class="n">fitted_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">fitted_data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fitted_y</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x_values</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Calculate R-squared value</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">fit_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">optimized_params</span><span class="p">)</span>
        <span class="n">ss_res</span><span class="p">,</span> <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>        
        <span class="n">r_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">ss_res</span> <span class="o">/</span> <span class="n">ss_tot</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>

        <span class="c1"># Create a string representation of the equation with optimized parameters</span>
        <span class="n">optimized_equation</span> <span class="o">=</span> <span class="n">equation</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">optimized_params</span><span class="p">):</span>
            <span class="n">optimized_equation</span> <span class="o">=</span> <span class="n">optimized_equation</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;c</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>

        <span class="n">fitted_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">optimized_equation</span><span class="si">}</span><span class="s1">, $R^2$ = </span><span class="si">{</span><span class="n">r_squared</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fitted_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optimized_params</span><span class="p">)</span>

    <span class="n">fitted_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, $y$ = </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span><span class="p">,</span> <span class="n">fitted_labels</span><span class="p">)]</span>         

    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">labels_eq</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;L*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $L^*$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;a*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $a^*$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;b*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $b^*$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $C^*$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $h$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dE76&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\Delta E^*_</span><span class="si">{ab}</span><span class="s1">$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dE00&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\Delta E^*_</span><span class="si">{00}</span><span class="s1">$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dR_VIS&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\Delta R_{\rm vis}$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dL*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $\Delta L^*$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;da*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $\Delta a^*$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;db*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $\Delta b^*$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dC*&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $\Delta C^*$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dh&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CIE $\Delta h$&#39;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">labels_H</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="s1">&#39;Exposure dose $H_v$ (Mlxh)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;Radiant Exposure $H_e$ (MJ/m²)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;t&#39;</span> <span class="p">:</span> <span class="s1">&#39;Exposure duration (seconds)&#39;</span>
        <span class="p">}</span>

        <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="mi">24</span>


        <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">wanted_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">fitted_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

        <span class="c1">#meas_line, = ax.plot(x,y, ls=&#39;-&#39;, lw=3)            </span>
        <span class="c1">#fitted_line, = ax.plot(x_values,fitted_y, ls=&#39;--&#39;, lw=2)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">labels_H</span><span class="p">[</span><span class="n">dose_unit</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels_eq</span><span class="p">[</span><span class="n">coordinate</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

        <span class="c1">#title = f&#39;Microfading, {self.Id}, data fitting&#39;</span>
        <span class="c1">#ax.set_title(title, fontsize = fs-4)   </span>

<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        if coordinate.startswith(&#39;d&#39;):                </span>
<span class="sd">            ax.set_ylim(0) </span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

        <span class="c1">#plt.legend([meas_line,fitted_line], [&quot;original data&quot;,f&quot;$f(x) = {optimized_equation}$\n$R^2 = {r_squared:.3f}$&quot;],fontsize=fs-6)</span>
        <span class="c1">#plt.tight_layout()</span>


        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>

            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_filename</span><span class="p">(</span><span class="s1">&#39;dEfit&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">save</span><span class="p">:</span>            
                <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                    <span class="n">path_fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_folder_figures</span><span class="p">()</span> <span class="o">/</span> <span class="n">filename</span>

                <span class="k">if</span> <span class="n">path_fig</span> <span class="o">==</span> <span class="s1">&#39;cwd&#39;</span><span class="p">:</span>
                    <span class="n">path_fig</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span> 

                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_fig</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fitted_parameters</span><span class="p">,</span> <span class="n">fitted_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_data" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">xarray</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_data" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the microfading data.</p>
<h5 id="microfading.microfading.MFT.get_data--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_data--parameters" title="Permanent link">&para;</a></h5>
<p>data : str|list, optional
    Possibility to select the type of data, by default 'all'.
    When 'all', it returns all the data (spectral and colorimetric).
    When 'sp', it only returns the spectral data.
    When 'cl', it only returns the colorimetric data.<br />
    When 'Lab', it returns the CIE L<em>a</em>b<em> values.
    A list of strings can be entered to select specific colourimetric data among the following: ['dE76,'dE00','dR_vis', 'L</em>', 'a<em>', 'b</em>', 'C*', 'h'].</p>


<details class="xarray-" open>
  <summary>bool, optional</summary>
  <p>When True, the data are returned as an xarray.Dataset object, else as pandas dataframe object, by default False.</p>
</details>        <h5 id="microfading.microfading.MFT.get_data--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_data--returns" title="Permanent link">&para;</a></h5>
<p>returns a list of pandas dataframes or xarray.Dataset objects</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">xarray</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the microfading data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : str|list, optional</span>
<span class="sd">        Possibility to select the type of data, by default &#39;all&#39;.</span>
<span class="sd">        When &#39;all&#39;, it returns all the data (spectral and colorimetric).</span>
<span class="sd">        When &#39;sp&#39;, it only returns the spectral data.</span>
<span class="sd">        When &#39;cl&#39;, it only returns the colorimetric data.  </span>
<span class="sd">        When &#39;Lab&#39;, it returns the CIE L*a*b* values.</span>
<span class="sd">        A list of strings can be entered to select specific colourimetric data among the following: [&#39;dE76,&#39;dE00&#39;,&#39;dR_vis&#39;, &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;].</span>

<span class="sd">    xarray : bool, optional</span>
<span class="sd">        When True, the data are returned as an xarray.Dataset object, else as pandas dataframe object, by default False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    returns a list of pandas dataframes or xarray.Dataset objects</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">all_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">])</span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[]</span> 

    <span class="k">for</span> <span class="n">data_file</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">:</span>

        <span class="n">sp</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span>            
        <span class="n">wl</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">He</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">Hv</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;t_sec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">L</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;L*&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;a*&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;b*&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;C*&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;h&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">dE76</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;dE76&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">dE00</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;dE00&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">dR_vis</span> <span class="o">=</span> <span class="n">data_file</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;dR_vis&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">spectral_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s1">&#39;sp&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;wavelength&#39;</span><span class="p">,</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">sp</span><span class="p">)</span>                
            <span class="p">},</span>
            <span class="n">coords</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="n">wl</span><span class="p">,</span>   
                <span class="s1">&#39;dose&#39;</span><span class="p">:</span> <span class="n">He</span><span class="p">,</span>
                <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">He</span><span class="p">),</span>
                <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">Hv</span><span class="p">),</span>  <span class="c1"># Match radiant energy</span>
                <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># Match radiant energy</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="n">color_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s1">&#39;L*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">L</span><span class="p">),</span>
                <span class="s1">&#39;a*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">a</span><span class="p">),</span>
                <span class="s1">&#39;b*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">b</span><span class="p">),</span>
                <span class="s1">&#39;C*&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">C</span><span class="p">),</span>
                <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">h</span><span class="p">),</span>
                <span class="s1">&#39;dE76&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE76</span><span class="p">),</span>
                <span class="s1">&#39;dE00&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dE00</span><span class="p">),</span>
                <span class="s1">&#39;dR_vis&#39;</span><span class="p">:</span> <span class="p">([</span><span class="s1">&#39;dose&#39;</span><span class="p">],</span> <span class="n">dR_vis</span><span class="p">),</span>
            <span class="p">},</span>
            <span class="n">coords</span><span class="o">=</span><span class="p">{</span>                    
                <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">He</span><span class="p">),</span>
                <span class="s1">&#39;Hv&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">Hv</span><span class="p">),</span>
                <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dose&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>                

        <span class="n">sp</span> <span class="o">=</span> <span class="n">spectral_data</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">([</span><span class="s2">&quot;He&quot;</span><span class="p">,</span><span class="s2">&quot;Hv&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
        <span class="n">cl</span> <span class="o">=</span> <span class="n">color_data</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">([</span><span class="s2">&quot;He&quot;</span><span class="p">,</span><span class="s2">&quot;Hv&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
        <span class="n">combined_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">sp</span><span class="p">,</span> <span class="n">cl</span><span class="p">])</span>

    <span class="n">all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>            


    <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="p">[</span><span class="n">data_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
            <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">data_sp</span><span class="p">,</span> <span class="n">data_cl</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">all_data</span>

    <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;sp&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="p">[</span><span class="n">data_sp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>                            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">sp</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">data_sp</span>

    <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;cl&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;dE76&#39;</span><span class="p">,</span><span class="s1">&#39;dE00&#39;</span><span class="p">,</span><span class="s1">&#39;dR_vis&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">data_cl</span>

    <span class="k">elif</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;Lab&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">]])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="s1">&#39;L*&#39;</span><span class="p">,</span><span class="s1">&#39;a*&#39;</span><span class="p">,</span><span class="s1">&#39;b*&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">data_cl</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">xarray</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">dic_doses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hv&#39;</span><span class="p">:</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;t_sec&#39;</span><span class="p">}</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">dic_doses</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dic_doses</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
            <span class="p">[</span><span class="n">data_cl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">data</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">elem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Hv&#39;</span><span class="p">,</span><span class="s1">&#39;He&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]]</span>
            <span class="n">data_cl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">data</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">data_cl</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter a valid data parameter. It can either be a string (&#39;sp&#39;, &#39;cl&#39;, &#39;Lab&#39;, &#39;all&#39;) or a list of strings [&#39;dE00&#39;,&#39;dE76&#39;, &#39;L*&#39;, &#39;a*&#39;, &#39;b*&#39;, &#39;C*&#39;, &#39;h&#39;]&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.get_metadata" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_metadata</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.get_metadata" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the metadata.</p>
<h5 id="microfading.microfading.MFT.get_metadata--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.get_metadata--parameters" title="Permanent link">&para;</a></h5>
<p>labels : Optional[list], optional
    A list of strings corresponding to the wanted metadata labels, by default 'all'
    The metadata labels can be found in the 'info' sheet of microfading excel files.
    When 'all', it returns all the metadata</p>
<h5 id="microfading.microfading.MFT.get_metadata--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.get_metadata--returns" title="Permanent link">&para;</a></h5>
<p>pandas dataframe
    It returns the metadata inside a pandas dataframe where each column corresponds to a single file.</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the metadata.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    labels : Optional[list], optional</span>
<span class="sd">        A list of strings corresponding to the wanted metadata labels, by default &#39;all&#39;</span>
<span class="sd">        The metadata labels can be found in the &#39;info&#39; sheet of microfading excel files.</span>
<span class="sd">        When &#39;all&#39;, it returns all the metadata</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the metadata inside a pandas dataframe where each column corresponds to a single file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">()</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="p">]</span>

    <span class="n">df_metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">)</span>
        <span class="n">Id</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

        <span class="n">df_metadata</span><span class="p">[</span><span class="n">Id</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df_metadata</span>

    <span class="k">else</span><span class="p">:</span>            
        <span class="k">return</span> <span class="n">df_metadata</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.mean" class="doc doc-heading">
            <code class=" language-python"><span class="n">mean</span><span class="p">(</span><span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.mean" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute mean and standard deviation values of several microfading measurements.</p>
<h5 id="microfading.microfading.MFT.mean--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.mean--parameters" title="Permanent link">&para;</a></h5>
<p>return_data : Optional[bool], optional
    Whether to return the data, by default True        </p>


<details class="criterion-" open>
  <summary>Optional[str], optional</summary>
  <p><em>description</em>, by default 'group'            </p>
</details>

<details class="save-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to save the average data as an excel file, by default False</p>
</details>

<details class="folder-" open>
  <summary>Optional[str], optional</summary>
  <p>Folder where the excel file will be saved, by default 'default'
When 'default', the file will be saved in the same folder as the input files
When '.', the file will be saved in the current working directory
One can also enter a valid path as a string.</p>
</details>

<details class="filename-" open>
  <summary>Optional[str], optional</summary>
  <p>Filename of the excel file containing the average values, by default 'default'
When 'default', it will use the filename of the first input file
One can also enter a filename, but without a filename extension.</p>
</details>        <h5 id="microfading.microfading.MFT.mean--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.mean--returns" title="Permanent link">&para;</a></h5>
<p>tuple, excel file
    It returns a tuple composed of three elements (info, CIELAB data, spectral data). When 'save' is set to True, an excel is created to stored the tuple inside three distinct excel sheet (info, CIELAB, spectra).</p>
<h5 id="microfading.microfading.MFT.mean--raises">Raises<a class="headerlink" href="#microfading.microfading.MFT.mean--raises" title="Permanent link">&para;</a></h5>
<p>RuntimeError
    <em>description</em></p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_data</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">criterion</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">folder</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute mean and standard deviation values of several microfading measurements.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    return_data : Optional[bool], optional</span>
<span class="sd">        Whether to return the data, by default True        </span>

<span class="sd">    criterion : Optional[str], optional</span>
<span class="sd">        _description_, by default &#39;group&#39;            </span>

<span class="sd">    save : Optional[bool], optional</span>
<span class="sd">        Whether to save the average data as an excel file, by default False</span>

<span class="sd">    folder : Optional[str], optional</span>
<span class="sd">        Folder where the excel file will be saved, by default &#39;default&#39;</span>
<span class="sd">        When &#39;default&#39;, the file will be saved in the same folder as the input files</span>
<span class="sd">        When &#39;.&#39;, the file will be saved in the current working directory</span>
<span class="sd">        One can also enter a valid path as a string.</span>

<span class="sd">    filename : Optional[str], optional</span>
<span class="sd">        Filename of the excel file containing the average values, by default &#39;default&#39;</span>
<span class="sd">        When &#39;default&#39;, it will use the filename of the first input file</span>
<span class="sd">        One can also enter a filename, but without a filename extension.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple, excel file</span>
<span class="sd">        It returns a tuple composed of three elements (info, CIELAB data, spectral data). When &#39;save&#39; is set to True, an excel is created to stored the tuple inside three distinct excel sheet (info, CIELAB, spectra).</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    RuntimeError</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>        
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Not enough files. At least two measurement files are required to compute the average values.&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">mean_std_with_nan</span><span class="p">(</span><span class="n">arrays</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute the mean of several numpy arrays of different shapes.&#39;&#39;&#39;</span>

        <span class="c1"># Find the maximum shape</span>
        <span class="n">max_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrays</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Create arrays with NaN values</span>
        <span class="n">nan_arrays</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">max_shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arrays</span><span class="p">))]</span>

        <span class="c1"># Fill NaN arrays with actual values</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arrays</span><span class="p">):</span>
            <span class="n">nan_arrays</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">arr</span>

        <span class="c1"># Calculate mean</span>
        <span class="n">mean_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">nan_arrays</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Calculate std</span>
        <span class="n">std_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">nan_arrays</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">mean_array</span><span class="p">,</span> <span class="n">std_array</span>


    <span class="k">def</span> <span class="nf">to_float</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>


    <span class="c1">###### SPECTRAL DATA #######</span>

    <span class="n">data_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>

    <span class="c1"># Get the energy dose step</span>
    <span class="n">H_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>       
    <span class="n">step_H</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H_values</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">highest_He</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H_values</span><span class="p">])</span>

    <span class="c1"># Average the spectral data</span>
    <span class="n">sp</span> <span class="o">=</span> <span class="n">mean_std_with_nan</span><span class="p">(</span><span class="n">data_sp</span><span class="p">)</span>
    <span class="n">sp_mean</span> <span class="o">=</span> <span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sp_std</span> <span class="o">=</span> <span class="n">sp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 


    <span class="c1"># Wanted energy dose values          </span>
    <span class="n">wanted_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">highest_He</span><span class="o">+</span><span class="n">step_H</span><span class="p">,</span><span class="n">step_H</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>  

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wanted_H</span><span class="p">)</span> <span class="o">!=</span> <span class="n">sp_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>            
        <span class="n">wanted_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">highest_He</span><span class="p">,</span><span class="n">sp_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Retrieve the wavelength range</span>
    <span class="n">wl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>


    <span class="c1"># Create a multi-index pandas DataFrame</span>
    <span class="n">H_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">dose</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span> <span class="k">for</span> <span class="n">dose</span> <span class="ow">in</span> <span class="n">wanted_H</span> <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]]</span>
    <span class="n">multiindex_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">H_tuples</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;Measurement&#39;</span><span class="p">])</span>

    <span class="n">data_df_sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">wl</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wanted_H</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>       
    <span class="n">data_df_sp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp_mean</span>
    <span class="n">data_df_sp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp_std</span>
    <span class="n">df_sp_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_df_sp</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">multiindex_cols</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">wl</span><span class="p">)</span>
    <span class="n">df_sp_final</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;wavelength_nm&#39;</span>



    <span class="c1">###### COLORIMETRIC DATA #######</span>

    <span class="n">data_cl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;dE&#39;</span><span class="p">)</span>
    <span class="n">columns_cl</span> <span class="o">=</span> <span class="n">data_cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>

    <span class="c1"># Average the colorimetric data    </span>
    <span class="n">cl</span> <span class="o">=</span> <span class="n">mean_std_with_nan</span><span class="p">(</span><span class="n">data_cl</span><span class="p">)</span>
    <span class="n">cl_mean</span> <span class="o">=</span> <span class="n">cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cl_std</span> <span class="o">=</span> <span class="n">cl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Create a multi-index pandas DataFrame</span>
    <span class="n">cl_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">measurement</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]]</span>
    <span class="n">multiindex_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">cl_tuples</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;Measurement&#39;</span><span class="p">])</span>

    <span class="n">data_df_cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">cl_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cl_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>       
    <span class="n">data_df_cl</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_mean</span>
    <span class="n">data_df_cl</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_std</span>
    <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_df_cl</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">multiindex_cols</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">df_cl_final</span><span class="o">.</span><span class="n">drop</span><span class="p">([(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;He_MJ/m2&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">):</span> <span class="p">(</span><span class="s1">&#39;t_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)}</span>
    <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([</span><span class="n">mapper</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>


    <span class="n">cl_cols</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">cl_cols_level1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cl_cols</span><span class="p">]</span>
    <span class="n">cl_cols_level2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cl_cols</span><span class="p">]</span>
    <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">df_cl_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cl_cols_level2</span><span class="p">])),</span> <span class="n">df_cl_final</span><span class="p">])</span>
    <span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cl_cols_level1</span>
    <span class="n">df_cl_final</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">df_cl_final</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


    <span class="c1">###### INFO #######</span>

    <span class="n">data_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

    <span class="c1"># Select the first column as a template</span>
    <span class="n">df_info</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>


    <span class="c1"># Rename title file</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;[SINGLE MICRO-FADING ANALYSIS]&#39;</span><span class="p">:</span> <span class="s1">&#39;[MEAN MICRO-FADING ANALYSES]&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Date time</span>
    <span class="n">most_recent_dt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;date_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">most_recent_dt</span>

    <span class="c1"># Project data info</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;projectleider&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;projectleider&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meelezer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meelezer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;aanvraagdatum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;aanvraagdatum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;uiterste_datum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;uiterste_datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>

    <span class="c1"># Object data info</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;institution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_creator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_creator&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_support&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;colorants_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;binding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;binding&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;thickness_microns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;thickness_microns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>

    <span class="c1"># Device data info</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;device&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurement_mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurement_mode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;zoom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;zoom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;iris&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;iris&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_ill_mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_ill_mm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_coll_mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;distance_coll_mm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))))</span>       

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fiber_coll&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;lamp_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_fading&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;filter_ill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_ref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;white_ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span>


    <span class="c1"># Analysis data info</span>

    <span class="n">criterion_value</span> <span class="o">=</span> <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">criterion</span><span class="p">]</span>
    <span class="n">object_id</span> <span class="o">=</span> <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_id&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;group&#39;</span><span class="p">:</span>            
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;MF.</span><span class="si">{</span><span class="n">object_id</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">criterion_value</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">elif</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span> <span class="ow">or</span> <span class="n">criterion</span> <span class="o">==</span> <span class="s1">&#39;project&#39;</span><span class="p">:</span>
         <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meas_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;MF.</span><span class="si">{</span><span class="n">criterion_value</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Choose one of the following options for the criterion parameter: [&quot;group&quot;, &quot;object&quot;, &quot;project&quot;]&#39;</span><span class="p">)</span>

    <span class="n">meas_nbs</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span><span class="p">])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">meas_nbs</span><span class="si">}</span><span class="s1">&#39;</span>    
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>  

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;specular_component&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])))</span> 


    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_ms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;integration_time_ms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span> 
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;duration_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;duration_min&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;interval_sec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;interval_sec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurements_N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;measurements_N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">))])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminant&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;observer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>


    <span class="c1"># Beam data info</span>

    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;beam_photo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;beam_photo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;resolution_micron/pixel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;resolution_micron/pixel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))))</span>

    <span class="n">fwhm</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;FWHM_micron&#39;</span><span class="p">]</span>
    <span class="n">fwhm_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">to_float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fwhm</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;FWHM_micron&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fwhm_avg</span>

    <span class="n">power_info</span> <span class="o">=</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;power_mW&#39;</span><span class="p">]</span>
    <span class="n">power_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">power_info</span><span class="p">])</span>
    <span class="n">power_ids</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">power_info</span><span class="p">])))</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;power_mW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">power_ids</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">power_avg</span><span class="si">}</span><span class="s1">&#39;</span> 

    <span class="n">irr_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">ufloat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;irradiance_W/m**2&#39;</span><span class="p">]</span> <span class="p">]</span> 
    <span class="n">irr_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">irr_values</span><span class="p">]))</span>
    <span class="n">irr_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">([</span><span class="n">unumpy</span><span class="o">.</span><span class="n">nominal_values</span><span class="p">(</span><span class="n">ufloat_fromstr</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">irr_values</span><span class="p">]))</span>
    <span class="n">irr_avg</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">irr_mean</span><span class="p">,</span> <span class="n">irr_std</span><span class="p">)</span>    
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;irradiance_W/m**2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">irr_avg</span>

    <span class="n">lm</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;luminuous_flux_lm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">lm_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lm</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;luminuous_flux_lm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lm_avg</span>

    <span class="n">ill</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminance_Mlx&#39;</span><span class="p">]]</span>
    <span class="n">ill_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ill</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;illuminance_Mlx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ill_avg</span>


    <span class="c1"># Results data info</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;totalDose_He_MJ/m**2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;totalDose_Hv_Mlxh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;Hv_Mlxh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fittedEqHe_dE00&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fittedEqHv_dE00&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fittedRate_dE00_at_2Mlxh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;fittedRate_dE00_at_20MJ/m**2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dE00_at_300klxh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dE00_at_3MJ/m**2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dEab_final&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dE76&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dE76&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dE00_final&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dE00&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dR_VIS_final&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dR_vis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">df_cl_final</span><span class="p">[</span><span class="s1">&#39;dR_vis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Hv_at_1dE00&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;BWSE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="c1"># Rename the column</span>
    <span class="n">df_info</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span>


    <span class="c1">###### SAVE THE MEAN DATAFRAMES #######</span>

    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>  

        <span class="c1"># set the folder</span>
        <span class="k">if</span> <span class="n">folder</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>  

        <span class="k">elif</span> <span class="n">folder</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">parent</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>         

        <span class="c1"># set the filename</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s1">_MEAN</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">.xlsx&#39;</span>


        <span class="c1"># create a excel writer object</span>
        <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">folder</span> <span class="o">/</span> <span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>

            <span class="n">df_info</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">df_cl_final</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;CIELAB&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">df_sp_final</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="c1">###### RETURN THE MEAN DATAFRAMES #######</span>

    <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl_final</span><span class="p">,</span> <span class="n">df_sp_final</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.plot_sp" class="doc doc-heading">
            <code class=" language-python"><span class="n">plot_sp</span><span class="p">(</span><span class="n">stds</span><span class="o">=</span><span class="p">[],</span> <span class="n">spectra</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">fontsize_legend</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">wl_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth_params</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">report</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.plot_sp" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the reflectance spectra corresponding to the associated microfading analyses.</p>
<h5 id="microfading.microfading.MFT.plot_sp--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.plot_sp--parameters" title="Permanent link">&para;</a></h5>
<p>stds : list, optional
     A list of standard variation values respective to each element given in the data parameter, by default []</p>


<details class="spectra-" open>
  <summary>Optional[str], optional</summary>
  <p>Define which spectra to display, by default 'i'
Use 'i' for initial spectral, 'f' for final spectra, 'i+f' for initial and final spectra, or 'all' for all the spectra.</p>
</details>

<details class="labels-" open>
  <summary>Union[str, list], optional</summary>
  <p><em>description</em>, by default 'default'</p>
</details>

<details class="title-" open>
  <summary>str, optional</summary>
  <p>Whether to add a title to the plot, by default None</p>
</details>

<details class="fontsize-" open>
  <summary>int, optional</summary>
  <p>Fontsize of the plot (title, ticks, and labels), by default 24</p>
</details>

<details class="fontsize_legend-" open>
  <summary>int, optional</summary>
  <p>Fontsize of the legend, by default 26</p>
</details>

<details class="wl_range-" open>
  <summary>tuple, optional</summary>
  <p>Define the wavelength range, by default None</p>
</details>

<details class="colors-" open>
  <summary>Union[str, list], optional</summary>
  <p>Define the colors of the reflectance curves, by default None
When 'sample', the color of each line will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) or a list of matplotlib colour values can be used. </p>
</details>

<details class="lw-" open>
  <summary>Union[int, list], optional</summary>
  <p>Define the width of the plot lines, by default 2
It can be a single integer value that will apply to all the curves. Or a list of integers can be used where the number of integer elements should match the number of reflectance curves.</p>
</details>

<details class="ls-" open>
  <summary>Union[str, list], optional</summary>
  <p>Define the line style of the plot lines, by default '-'
It can be a string ('-', '--', ':', '-.') that will apply to all the curves. Or a list of string can be used where the number of string elements should match the number of reflectance curves.</p>
</details>

<details class="save-" open>
  <summary>bool, optional</summary>
  <p>Whether to save the figure, by default False</p>
</details>

<details class="path_fig-" open>
  <summary>str, optional</summary>
  <p>Absolute path required to save the figure, by default 'cwd'
When 'cwd', it will save the figure in the current working directory.</p>
</details>

<details class="derivation-" open>
  <summary>bool, optional</summary>
  <p>Wether to compute and display the first derivative values of the spectra, by default False</p>
</details>

<details class="smooth-" open>
  <summary>bool, optional</summary>
  <p>Whether to smooth the reflectance curves, by default False</p>
</details>

<details class="smooth_params-" open>
  <summary>list, optional</summary>
  <p>Parameters related to the Savitzky-Golay filter, by default [10,1]
Enter a list of two integers where the first value corresponds to the window_length and the second to the polyorder value. </p>
</details>

<details class="report-" open>
  <summary>Optional[bool], optional</summary>
  <p><em>description</em>, by default False</p>
</details>        <h5 id="microfading.microfading.MFT.plot_sp--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.plot_sp--returns" title="Permanent link">&para;</a></h5>
<p><em>type</em>
    <em>description</em></p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_sp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stds</span><span class="o">=</span><span class="p">[],</span> <span class="n">spectra</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">fontsize_legend</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">26</span><span class="p">,</span> <span class="n">wl_range</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="s1">&#39;cwd&#39;</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth_params</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">report</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the reflectance spectra corresponding to the associated microfading analyses.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    stds : list, optional</span>
<span class="sd">         A list of standard variation values respective to each element given in the data parameter, by default []</span>

<span class="sd">    spectra : Optional[str], optional</span>
<span class="sd">        Define which spectra to display, by default &#39;i&#39;</span>
<span class="sd">        Use &#39;i&#39; for initial spectral, &#39;f&#39; for final spectra, &#39;i+f&#39; for initial and final spectra, or &#39;all&#39; for all the spectra.</span>

<span class="sd">    labels : Union[str, list], optional</span>
<span class="sd">        _description_, by default &#39;default&#39;</span>

<span class="sd">    title : str, optional</span>
<span class="sd">        Whether to add a title to the plot, by default None</span>

<span class="sd">    fontsize : int, optional</span>
<span class="sd">        Fontsize of the plot (title, ticks, and labels), by default 24</span>

<span class="sd">    fontsize_legend : int, optional</span>
<span class="sd">        Fontsize of the legend, by default 26</span>

<span class="sd">    wl_range : tuple, optional</span>
<span class="sd">        Define the wavelength range, by default None</span>

<span class="sd">    colors : Union[str, list], optional</span>
<span class="sd">        Define the colors of the reflectance curves, by default None</span>
<span class="sd">        When &#39;sample&#39;, the color of each line will be based on srgb values computed from the reflectance values. Alternatively, a single string value can be used to define the color (see matplotlib colour values) or a list of matplotlib colour values can be used. </span>

<span class="sd">    lw : Union[int, list], optional</span>
<span class="sd">        Define the width of the plot lines, by default 2</span>
<span class="sd">        It can be a single integer value that will apply to all the curves. Or a list of integers can be used where the number of integer elements should match the number of reflectance curves.</span>

<span class="sd">    ls : Union[str, list], optional</span>
<span class="sd">        Define the line style of the plot lines, by default &#39;-&#39;</span>
<span class="sd">        It can be a string (&#39;-&#39;, &#39;--&#39;, &#39;:&#39;, &#39;-.&#39;) that will apply to all the curves. Or a list of string can be used where the number of string elements should match the number of reflectance curves.</span>

<span class="sd">    save : bool, optional</span>
<span class="sd">        Whether to save the figure, by default False</span>

<span class="sd">    path_fig : str, optional</span>
<span class="sd">        Absolute path required to save the figure, by default &#39;cwd&#39;</span>
<span class="sd">        When &#39;cwd&#39;, it will save the figure in the current working directory.</span>

<span class="sd">    derivation : bool, optional</span>
<span class="sd">        Wether to compute and display the first derivative values of the spectra, by default False</span>

<span class="sd">    smooth : bool, optional</span>
<span class="sd">        Whether to smooth the reflectance curves, by default False</span>

<span class="sd">    smooth_params : list, optional</span>
<span class="sd">        Parameters related to the Savitzky-Golay filter, by default [10,1]</span>
<span class="sd">        Enter a list of two integers where the first value corresponds to the window_length and the second to the polyorder value. </span>

<span class="sd">    report : Optional[bool], optional</span>
<span class="sd">        _description_, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    _type_</span>
<span class="sd">        _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Retrieve the data</span>
    <span class="n">data_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>
    <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>        
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span> 


    <span class="c1"># Whether to smooth the data</span>
    <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
            <span class="n">data_sp</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="n">smooth_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polyorder</span><span class="o">=</span><span class="n">smooth_params</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">idx</span><span class="p">,</span><span class="n">cols</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data_sp</span><span class="p">,</span><span class="n">indices</span><span class="p">,</span><span class="n">columns</span><span class="p">)]</span>       

    <span class="c1"># Reset the index</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_sp</span><span class="p">]</span>

    <span class="c1"># Whether to compute the first derivative</span>
    <span class="k">if</span> <span class="n">derivation</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

    <span class="c1"># Retrieve the metadata</span>
    <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
    <span class="n">object_info</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">object_technique</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;object_technique&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">group_nb</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">group_descriptions</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;group_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">group_description</span> <span class="o">=</span> <span class="n">group_descriptions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span> <span class="k">if</span> <span class="s1">&#39;BW&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">meas_nbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>

    <span class="c1"># Select which spectra to plot </span>
    <span class="k">if</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>            
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Initial spectra&#39;</span>

    <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>             
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Final spectra&#39;</span>          

    <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s2">&quot;i+f&quot;</span><span class="p">:</span>
        <span class="n">list_data</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">l1</span> <span class="ow">in</span> <span class="n">list_data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">l2</span> <span class="ow">in</span> <span class="n">l1</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>

        <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">colors</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">meas_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">meas_nbs</span><span class="p">,</span><span class="n">group_descriptions</span><span class="p">)]</span>
        <span class="n">none_labels</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">meas_labels</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">none_labels</span><span class="p">,</span> <span class="n">meas_labels</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Initial (black dashed lines) and final spectra&#39;</span>

    <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span> <span class="p">:</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">data_sp</span>
        <span class="p">]</span>
        <span class="c1">#data = [(x.iloc[:,0].values, x.iloc[:,1:].values) for x in data]            </span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;All spectra&#39;</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="kc">None</span>


    <span class="k">return</span> <span class="n">plotting</span><span class="o">.</span><span class="n">spectra</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">stds</span><span class="o">=</span><span class="p">[],</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">fontsize_legend</span><span class="o">=</span><span class="n">fontsize_legend</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="n">wl_range</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">path_fig</span><span class="o">=</span><span class="n">path_fig</span><span class="p">,</span> <span class="n">derivation</span><span class="o">=</span><span class="n">derivation</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.read_files" class="doc doc-heading">
            <code class=" language-python"><span class="n">read_files</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;spectra&#39;</span><span class="p">])</span></code>

<a href="#microfading.microfading.MFT.read_files" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Read the data files given as argument when defining the instance of the MFT class.</p>
<h5 id="microfading.microfading.MFT.read_files--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.read_files--parameters" title="Permanent link">&para;</a></h5>
<p>sheets : Optional[list], optional
    Name of the excel sheets to be selected, by default ['info', 'CIELAB', 'spectra']</p>
<h5 id="microfading.microfading.MFT.read_files--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.read_files--returns" title="Permanent link">&para;</a></h5>
<p>pandas dataframe
    It returns of the content of the files where the each column relates to a file.</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;spectra&#39;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read the data files given as argument when defining the instance of the MFT class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sheets : Optional[list], optional</span>
<span class="sd">        Name of the excel sheets to be selected, by default [&#39;info&#39;, &#39;CIELAB&#39;, &#39;spectra&#39;]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns of the content of the files where the each column relates to a file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>        

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>

        <span class="n">df_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
        <span class="n">df_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;spectra&#39;</span><span class="p">)</span>
        <span class="n">df_cl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;std&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_sp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="n">df_sp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">df_cl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>


        <span class="k">if</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span> <span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_cl</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_sp</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;spectra&#39;</span><span class="p">,</span> <span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">,</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_cl</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="s1">&#39;CIELAB&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_cl</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">sheets</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="s1">&#39;spectra&#39;</span><span class="p">]:</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df_info</span><span class="p">,</span> <span class="n">df_sp</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">files</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.sRGB" class="doc doc-heading">
            <code class=" language-python"><span class="n">sRGB</span><span class="p">(</span><span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.sRGB" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the sRGB values. </p>
<h5 id="microfading.microfading.MFT.sRGB--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.sRGB--parameters" title="Permanent link">&para;</a></h5>
<p>illuminant : (str, optional)<br />
    Reference <em>illuminant</em> ('D65', or 'D50'). by default 'D65'.</p>


<details class="observer-" open>
  <summary>(str|int, optional)</summary>
  <p>Reference <em>observer</em> in degree ('10' or '2'). by default '10'.</p>
</details>        <h5 id="microfading.microfading.MFT.sRGB--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.sRGB--returns" title="Permanent link">&para;</a></h5>
<p>pandas dataframe
    It returns the sRGB values inside a dataframe where each column corresponds to a single file.</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sRGB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the sRGB values. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    illuminant : (str, optional)  </span>
<span class="sd">        Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;D65&#39;.</span>

<span class="sd">    observer : (str|int, optional)</span>
<span class="sd">        Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;10&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the sRGB values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">observer</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

    <span class="n">illuminants</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D65&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D65&#39;</span><span class="p">],</span> <span class="s1">&#39;D50&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D50&#39;</span><span class="p">]}</span>
    <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
        <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
        <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
        <span class="p">}</span>

    <span class="n">ccs_ill</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>

    <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span>                
    <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>       
    <span class="n">df_srgb</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

        <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

            <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">illuminants</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span> 
            <span class="n">srgb</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_sRGB</span><span class="p">(</span><span class="n">XYZ</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">ccs_ill</span><span class="p">)</span>                          
            <span class="n">srgb_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">srgb_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">srgb</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">srgb_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">srgb_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">srgb_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">srgb_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
        <span class="n">df_srgb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">srgb_values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_srgb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.set_illuminant" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_illuminant</span><span class="p">(</span><span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.set_illuminant" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the illuminant values.</p>
<h5 id="microfading.microfading.MFT.set_illuminant--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.set_illuminant--parameters" title="Permanent link">&para;</a></h5>
<p>illuminant : Optional[str], optional
    Select the illuminant, by default 'D65'
    It can be any value within the following list: ['A', 'B', 'C', 'D50', 'D55', 'D60', 'D65', 'D75', 'E', 'FL1', 'FL2', 'FL3', 'FL4', 'FL5', 'FL6', 'FL7', 'FL8', 'FL9', 'FL10', 'FL11', 'FL12', 'FL3.1', 'FL3.2', 'FL3.3', 'FL3.4', 'FL3.5', 'FL3.6', 'FL3.7', 'FL3.8', 'FL3.9', 'FL3.10', 'FL3.11', 'FL3.12', 'FL3.13', 'FL3.14', 'FL3.15', 'HP1', 'HP2', 'HP3', 'HP4', 'HP5', 'LED-B1', 'LED-B2', 'LED-B3', 'LED-B4', 'LED-B5', 'LED-BH1', 'LED-RGB1', 'LED-V1', 'LED-V2', 'ID65', 'ID50', 'ISO 7589 Photographic Daylight', 'ISO 7589 Sensitometric Daylight', 'ISO 7589 Studio Tungsten', 'ISO 7589 Sensitometric Studio Tungsten', 'ISO 7589 Photoflood', 'ISO 7589 Sensitometric Photoflood', 'ISO 7589 Sensitometric Printer']</p>


<details class="observer-" open>
  <summary>Optional[str], optional</summary>
  <p>Standard observer in degree, by default '10'
It can be either '2' or '10'</p>
</details>        <h5 id="microfading.microfading.MFT.set_illuminant--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.set_illuminant--returns" title="Permanent link">&para;</a></h5>
<p>tuple
    It returns a tuple with two set of values: the chromaticity coordinates of the illuminants (CCS) and the spectral distribution of the illuminants (SDS).</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_illuminant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the illuminant values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    illuminant : Optional[str], optional</span>
<span class="sd">        Select the illuminant, by default &#39;D65&#39;</span>
<span class="sd">        It can be any value within the following list: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D50&#39;, &#39;D55&#39;, &#39;D60&#39;, &#39;D65&#39;, &#39;D75&#39;, &#39;E&#39;, &#39;FL1&#39;, &#39;FL2&#39;, &#39;FL3&#39;, &#39;FL4&#39;, &#39;FL5&#39;, &#39;FL6&#39;, &#39;FL7&#39;, &#39;FL8&#39;, &#39;FL9&#39;, &#39;FL10&#39;, &#39;FL11&#39;, &#39;FL12&#39;, &#39;FL3.1&#39;, &#39;FL3.2&#39;, &#39;FL3.3&#39;, &#39;FL3.4&#39;, &#39;FL3.5&#39;, &#39;FL3.6&#39;, &#39;FL3.7&#39;, &#39;FL3.8&#39;, &#39;FL3.9&#39;, &#39;FL3.10&#39;, &#39;FL3.11&#39;, &#39;FL3.12&#39;, &#39;FL3.13&#39;, &#39;FL3.14&#39;, &#39;FL3.15&#39;, &#39;HP1&#39;, &#39;HP2&#39;, &#39;HP3&#39;, &#39;HP4&#39;, &#39;HP5&#39;, &#39;LED-B1&#39;, &#39;LED-B2&#39;, &#39;LED-B3&#39;, &#39;LED-B4&#39;, &#39;LED-B5&#39;, &#39;LED-BH1&#39;, &#39;LED-RGB1&#39;, &#39;LED-V1&#39;, &#39;LED-V2&#39;, &#39;ID65&#39;, &#39;ID50&#39;, &#39;ISO 7589 Photographic Daylight&#39;, &#39;ISO 7589 Sensitometric Daylight&#39;, &#39;ISO 7589 Studio Tungsten&#39;, &#39;ISO 7589 Sensitometric Studio Tungsten&#39;, &#39;ISO 7589 Photoflood&#39;, &#39;ISO 7589 Sensitometric Photoflood&#39;, &#39;ISO 7589 Sensitometric Printer&#39;]</span>

<span class="sd">    observer : Optional[str], optional</span>
<span class="sd">        Standard observer in degree, by default &#39;10&#39;</span>
<span class="sd">        It can be either &#39;2&#39; or &#39;10&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        It returns a tuple with two set of values: the chromaticity coordinates of the illuminants (CCS) and the spectral distribution of the illuminants (SDS).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s2">&quot;cie_10_1964&quot;</span><span class="p">,</span>
        <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s2">&quot;cie_2_1931&quot;</span>
    <span class="p">}</span>

    <span class="n">CCS</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">CCS_ILLUMINANTS</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]][</span><span class="n">illuminant</span><span class="p">]</span>
    <span class="n">SDS</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="n">illuminant</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">CCS</span><span class="p">,</span> <span class="n">SDS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.set_observer" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_observer</span><span class="p">(</span><span class="n">observer</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.set_observer" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the observer.</p>
<h5 id="microfading.microfading.MFT.set_observer--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.set_observer--parameters" title="Permanent link">&para;</a></h5>
<p>observer : Optional[str], optional
    Standard observer in degree, by default '10'
    It can be either '2' or '10'</p>
<h5 id="microfading.microfading.MFT.set_observer--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.set_observer--returns" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code>Returns the x_bar,  y_bar, z_bar spectra between 360 and 830 nm.
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_observer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the observer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    observer : Optional[str], optional</span>
<span class="sd">        Standard observer in degree, by default &#39;10&#39;</span>
<span class="sd">        It can be either &#39;2&#39; or &#39;10&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------        </span>
<span class="sd">        Returns the x_bar,  y_bar, z_bar spectra between 360 and 830 nm.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">,</span>
        <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="n">observers</span><span class="p">[</span><span class="n">observer</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.sp_derivation" class="doc doc-heading">
            <code class=" language-python"><span class="n">sp_derivation</span><span class="p">()</span></code>

<a href="#microfading.microfading.MFT.sp_derivation" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the first derivative values of reflectance spectra.</p>
<h5 id="microfading.microfading.MFT.sp_derivation--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.sp_derivation--returns" title="Permanent link">&para;</a></h5>
<p>a list of pandas dataframes
    It returns the first derivative values of the reflectance spectra inside dataframes where each column corresponds to a single spectra.</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sp_derivation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the first derivative values of reflectance spectra.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    a list of pandas dataframes</span>
<span class="sd">        It returns the first derivative values of the reflectance spectra inside dataframes where each column corresponds to a single spectra.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>                    

    <span class="n">sp_derivation</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sp</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">sp_derivation</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="microfading.microfading.MFT.xy" class="doc doc-heading">
            <code class=" language-python"><span class="n">xy</span><span class="p">(</span><span class="n">illuminant</span><span class="o">=</span><span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">)</span></code>

<a href="#microfading.microfading.MFT.xy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the xy values. </p>
<h5 id="microfading.microfading.MFT.xy--parameters">Parameters<a class="headerlink" href="#microfading.microfading.MFT.xy--parameters" title="Permanent link">&para;</a></h5>
<p>illuminant : (str, optional)<br />
    Reference <em>illuminant</em> ('D65', or 'D50'). by default 'D65'.</p>


<details class="observer-" open>
  <summary>(str|int, optional)</summary>
  <p>Reference <em>observer</em> in degree ('10' or '2'). by default '10'.</p>
</details>        <h5 id="microfading.microfading.MFT.xy--returns">Returns<a class="headerlink" href="#microfading.microfading.MFT.xy--returns" title="Permanent link">&para;</a></h5>
<p>pandas dataframe
    It returns the xy values inside a dataframe where each column corresponds to a single file.</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">illuminant</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;D65&#39;</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the xy values. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    illuminant : (str, optional)  </span>
<span class="sd">        Reference *illuminant* (&#39;D65&#39;, or &#39;D50&#39;). by default &#39;D65&#39;.</span>

<span class="sd">    observer : (str|int, optional)</span>
<span class="sd">        Reference *observer* in degree (&#39;10&#39; or &#39;2&#39;). by default &#39;10&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas dataframe</span>
<span class="sd">        It returns the xy values inside a dataframe where each column corresponds to a single file.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">observer</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

    <span class="n">illuminants</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D65&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D65&#39;</span><span class="p">],</span> <span class="s1">&#39;D50&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D50&#39;</span><span class="p">]}</span>
    <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
        <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
        <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
        <span class="p">}</span>

    <span class="n">meas_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meas_ids</span>                
    <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>       
    <span class="n">df_xy</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">meas_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_sp</span><span class="p">,</span> <span class="n">meas_ids</span><span class="p">):</span>

        <span class="n">xy_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>           

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="n">sp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="n">wl</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>                

            <span class="n">XYZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">illuminants</span><span class="p">[</span><span class="n">illuminant</span><span class="p">]),</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_xy</span><span class="p">(</span><span class="n">XYZ</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">xy_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">xy_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">xy_values</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">xy_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">xy_values</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="n">meas_id</span><span class="p">],</span> <span class="n">xy_values</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
        <span class="n">df_xy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy_values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_xy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>





















    <span class="n">observer</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

    <span class="n">illuminants</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D65&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D65&#39;</span><span class="p">],</span> <span class="s1">&#39;D50&#39;</span><span class="p">:</span><span class="n">colour</span><span class="o">.</span><span class="n">SDS_ILLUMINANTS</span><span class="p">[</span><span class="s1">&#39;D50&#39;</span><span class="p">]}</span>
    <span class="n">observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s1">&#39;cie_10_1964&#39;</span><span class="p">,</span>
        <span class="s1">&#39;2&#39;</span> <span class="p">:</span> <span class="s1">&#39;cie_2_1931&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">cmfs_observers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1964 10 Degree Standard Observer&quot;</span><span class="p">],</span>
        <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="n">colour</span><span class="o">.</span><span class="n">colorimetry</span><span class="o">.</span><span class="n">MSDS_CMFS_STANDARD_OBSERVER</span><span class="p">[</span><span class="s2">&quot;CIE 1931 2 Degree Standard Observer&quot;</span><span class="p">]</span> 
        <span class="p">}</span>

    <span class="n">df_xy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]))</span>
    <span class="n">df_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;sp&#39;</span><span class="p">)</span>
    <span class="n">wl</span> <span class="o">=</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">index</span>

    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_sp</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="n">df_sp</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">SpectralDistribution</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">wl</span><span class="p">)</span>

        <span class="n">XYZ</span> <span class="o">=</span> <span class="n">colour</span><span class="o">.</span><span class="n">sd_to_XYZ</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span><span class="n">cmfs_observers</span><span class="p">[</span><span class="n">observer</span><span class="p">],</span> <span class="n">illuminant</span><span class="o">=</span><span class="n">illuminants</span><span class="p">[</span><span class="n">illuminant</span><span class="p">])</span> 
        <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">colour</span><span class="o">.</span><span class="n">XYZ_to_xy</span><span class="p">(</span><span class="n">XYZ</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>

        <span class="n">df_xy</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">xy</span>

    <span class="k">return</span> <span class="n">df_xy</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.create_DB" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_DB</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span></code>

<a href="#microfading.microfading.create_DB" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create two empty databases, one for the projects and one for the objects.</p>
<h4 id="microfading.microfading.create_DB--parameters">Parameters<a class="headerlink" href="#microfading.microfading.create_DB--parameters" title="Permanent link">&para;</a></h4>
<p>folder : str
    Absolute path of the folder where the databases will be stored.</p>
<h4 id="microfading.microfading.create_DB--returns">Returns<a class="headerlink" href="#microfading.microfading.create_DB--returns" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>It creates the two empty databases as csv file (DB_projects.csv and DB_objects.csv) in the folder given as input.
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_DB</span><span class="p">(</span><span class="n">folder</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create two empty databases, one for the projects and one for the objects.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    folder : str</span>
<span class="sd">        Absolute path of the folder where the databases will be stored.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        It creates the two empty databases as csv file (DB_projects.csv and DB_objects.csv) in the folder given as input.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>
    <span class="n">DB</span><span class="o">.</span><span class="n">create_db</span><span class="p">(</span><span class="n">folder_path</span><span class="o">=</span><span class="n">folder</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.folder_DB" class="doc doc-heading">
            <code class=" language-python"><span class="n">folder_DB</span><span class="p">()</span></code>

<a href="#microfading.microfading.folder_DB" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve the absolute path of the folder where the databases are located.</p>
<h4 id="microfading.microfading.folder_DB--returns">Returns<a class="headerlink" href="#microfading.microfading.folder_DB--returns" title="Permanent link">&para;</a></h4>
<p>string or None</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">folder_DB</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the absolute path of the folder where the databases are located.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    string or None        </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DB</span> <span class="o">=</span> <span class="n">databases</span><span class="o">.</span><span class="n">DB</span><span class="p">()</span>    

    <span class="k">if</span> <span class="s1">&#39;DB_projects.csv&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">folder_db</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;DB_objects.csv&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">DB</span><span class="o">.</span><span class="n">folder_db</span><span class="p">):</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;DB_projects.csv and DB_objects.csv files can be found in the following folder: </span><span class="si">{</span><span class="n">DB</span><span class="o">.</span><span class="n">folder_db</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>    
        <span class="k">return</span> <span class="n">DB</span><span class="o">.</span><span class="n">folder_db</span>       

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Databases have not been created or have been deleted. Please, create databases by running the function &quot;create_DB&quot; from the microfading package.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="microfading.microfading.get_datasets" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_datasets</span><span class="p">(</span><span class="n">rawfiles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">BWS</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stdev</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#microfading.microfading.get_datasets" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Retrieve exemples of dataset files. These files are meant to give the users the possibility to test the MFT class and its functions.  </p>
<h4 id="microfading.microfading.get_datasets--parameters">Parameters<a class="headerlink" href="#microfading.microfading.get_datasets--parameters" title="Permanent link">&para;</a></h4>
<p>rawfiles : Optional[bool], optional
    Whether to get rawdata files, by default False
    The raw files were obtained from microfading analyses performed with the Fotonowy device and consist of four files per analysis.</p>


<details class="bws-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to include the microfading measurements on blue wool standards (BWS), by default True</p>
</details>

<details class="stdev-" open>
  <summary>Optional[bool], optional</summary>
  <p>Whether to have microfading measurements wiht standard deviation values, by default False</p>
</details>        <h4 id="microfading.microfading.get_datasets--returns">Returns<a class="headerlink" href="#microfading.microfading.get_datasets--returns" title="Permanent link">&para;</a></h4>
<p>list
    It returns a list of strings, where each string corresponds the absolute path of a microfading measurement excel file. Subsequently, one can use the list as input for the MFT class.</p>

            <details class="quote">
              <summary>Source code in <code>src/microfading/microfading.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_datasets</span><span class="p">(</span><span class="n">rawfiles</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">BWS</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">stdev</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve exemples of dataset files. These files are meant to give the users the possibility to test the MFT class and its functions.  </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rawfiles : Optional[bool], optional</span>
<span class="sd">        Whether to get rawdata files, by default False</span>
<span class="sd">        The raw files were obtained from microfading analyses performed with the Fotonowy device and consist of four files per analysis.</span>

<span class="sd">    BWS : Optional[bool], optional</span>
<span class="sd">        Whether to include the microfading measurements on blue wool standards (BWS), by default True</span>

<span class="sd">    stdev : Optional[bool], optional</span>
<span class="sd">        Whether to have microfading measurements wiht standard deviation values, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        It returns a list of strings, where each string corresponds the absolute path of a microfading measurement excel file. Subsequently, one can use the list as input for the MFT class. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">stdev</span><span class="p">:</span>
        <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;2024-144_MF.BWS0024.G01_avg_BW1_model_2024-07-30_MFT2.xlsx&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144_MF.BWS0025.G01_avg_BW2_model_2024-08-02_MFT2.xlsx&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144_MF.BWS0026.G01_avg_BW3_model_2024-08-07_MFT2.xlsx&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144_MF.dayflower4.G01_avg_0h_model_2024-07-30_MFT2.xlsx&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144_MF.indigo3.G01_avg_0h_model_2024-08-02_MFT2.xlsx&#39;</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;2024-144_MF.BWS0026.04_G02_BW3_model_2024-08-02_MFT1.xlsx&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144_MF.BWS0025.04_G02_BW2_model_2024-08-02_MFT1.xlsx&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144_MF.BWS0024.04_G02_BW1_model_2024-08-02_MFT1.xlsx&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144_MF.yellowwood.01_G01_yellow_model_2024-08-01_MFT1.xlsx&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144_MF.vermillon.01_G01_red_model_2024-07-31_MFT1.xlsx&#39;</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">rawfiles</span><span class="p">:</span>
        <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;2024-8200 P-001 G01 uncleaned_01-spect_convert.txt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-8200 P-001 G01 uncleaned_01-spect.txt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-8200 P-001 G01 uncleaned_01.txt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-8200 P-001 G01 uncleaned_01.rfc&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144 BWS0024 G01 BW1_01-spect_convert.txt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144 BWS0024 G01 BW1_01-spect.txt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144 BWS0024 G01 BW1_01.txt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2024-144 BWS0024 G01 BW1_01.rfc&#39;</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">BWS</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_files</span> <span class="k">if</span> <span class="s1">&#39;BWS&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>



    <span class="c1"># Get the paths to the data files within the package</span>
    <span class="n">file_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">data_files</span><span class="p">:</span>

        <span class="k">with</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="s1">&#39;microfading.datasets&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">data_file</span><span class="p">:</span>
             <span class="n">file_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">file_paths</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>